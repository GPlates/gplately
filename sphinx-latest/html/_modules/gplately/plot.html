

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>gplately.plot &mdash; gplately 2.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=51b770b3"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            gplately
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../basic_usages.html">Minimal working example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../use_cases.html">Common Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Trouble-shooting and FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../command_line_interface.html">Command Line Interface (CLI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../primer.html">Primer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">GPlately API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">gplately</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">gplately.plot</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for gplately.plot</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">#    Copyright (C) 2024 The University of Sydney, Australia</span>
<span class="c1">#</span>
<span class="c1">#    This program is free software; you can redistribute it and/or modify it under</span>
<span class="c1">#    the terms of the GNU General Public License, version 2, as published by</span>
<span class="c1">#    the Free Software Foundation.</span>
<span class="c1">#</span>
<span class="c1">#    This program is distributed in the hope that it will be useful, but WITHOUT</span>
<span class="c1">#    ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span>
<span class="c1">#    FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License</span>
<span class="c1">#    for more details.</span>
<span class="c1">#</span>
<span class="c1">#    You should have received a copy of the GNU General Public License along</span>
<span class="c1">#    with this program; if not, write to Free Software Foundation, Inc.,</span>
<span class="c1">#    51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.</span>
<span class="c1">#</span>

<span class="sd">&quot;&quot;&quot;This sub-module contains tools for reconstructing and plotting geological features and feature data through time.</span>

<span class="sd">Methods in `plot.py` reconstruct geological features using</span>
<span class="sd">[pyGPlates&#39; `reconstruct` function](https://www.gplates.org/docs/pygplates/generated/pygplates.reconstruct.html),</span>
<span class="sd">turns them into plottable Shapely geometries, and plots them onto Cartopy GeoAxes using Shapely and GeoPandas.</span>

<span class="sd">Classes</span>
<span class="sd">-------</span>
<span class="sd">PlotTopologies</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">partial</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pygplates</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseGeometry</span><span class="p">,</span> <span class="n">BaseMultipartGeometry</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.ops</span><span class="w"> </span><span class="kn">import</span> <span class="n">linemerge</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">ptt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">append_docstring</span><span class="p">,</span>
    <span class="n">validate_reconstruction_time</span><span class="p">,</span>
    <span class="n">validate_topology_availability</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.gpml</span><span class="w"> </span><span class="kn">import</span> <span class="n">_load_FeatureCollection</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.mapping.cartopy_plot</span><span class="w"> </span><span class="kn">import</span> <span class="n">DEFAULT_CARTOPY_PROJECTION</span><span class="p">,</span> <span class="n">CartopyPlotEngine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.mapping.plot_engine</span><span class="w"> </span><span class="kn">import</span> <span class="n">PlotEngine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.reconstruction</span><span class="w"> </span><span class="kn">import</span> <span class="n">PlateReconstruction</span> <span class="k">as</span> <span class="n">_PlateReconstruction</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">EARTH_RADIUS</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.utils.feature_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">shapelify_features</span> <span class="k">as</span> <span class="n">_shapelify_features</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.utils.plot_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">_meridian_from_ax</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.utils.plot_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_subduction_teeth</span> <span class="k">as</span> <span class="n">_plot_subduction_teeth</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;gplately&quot;</span><span class="p">)</span>

<span class="n">PLOT_DOCSTRING</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>

<span class="s2">        Parameters</span>
<span class="s2">        ----------</span>
<span class="s2">        ax : instance of &lt;cartopy.mpl.geoaxes.GeoAxes&gt; or &lt;cartopy.mpl.geoaxes.GeoAxesSubplot&gt;</span>
<span class="s2">            A subclass of `matplotlib.axes.Axes` which represents a map Projection.</span>
<span class="s2">            The map should be set at a particular Cartopy projection.</span>

<span class="s2">        color : str, default=’black’</span>
<span class="s2">            The colour of the `</span><span class="si">{0}</span><span class="s2">` lines. By default, it is set to black.</span>

<span class="s2">        **kwargs :</span>
<span class="s2">            Keyword arguments for parameters such as `alpha`, etc. for plotting `</span><span class="si">{0}</span><span class="s2">` geometries.</span>
<span class="s2">            See `Matplotlib` keyword arguments [here](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html).</span>

<span class="s2">        Returns</span>
<span class="s2">        -------</span>
<span class="s2">        ax : instance of &lt;geopandas.GeoDataFrame.plot&gt;</span>
<span class="s2">            A standard cartopy.mpl.geoaxes.GeoAxes or cartopy.mpl.geoaxes.GeoAxesSubplot map</span>
<span class="s2">            with `</span><span class="si">{0}</span><span class="s2">` features plotted onto the chosen map projection.</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">GET_DATE_DOCSTRING</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>

<span class="s2">        Parameters</span>
<span class="s2">        ----------</span>
<span class="s2">        central_meridian : float</span>
<span class="s2">            Central meridian around which to perform wrapping; default: 0.0.</span>
<span class="s2">        tessellate_degrees : float or None</span>
<span class="s2">            If provided, geometries will be tessellated to this resolution prior</span>
<span class="s2">            to wrapping.</span>

<span class="s2">        Returns</span>
<span class="s2">        -------</span>
<span class="s2">        geopandas.GeoDataFrame</span>
<span class="s2">            A pandas.DataFrame that has a column with `</span><span class="si">{0}</span><span class="s2">` geometry.</span>

<span class="s2">        Raises</span>
<span class="s2">        ------</span>
<span class="s2">        ValueError</span>
<span class="s2">            If the optional `time` parameter has not been passed to</span>
<span class="s2">            `PlotTopologies`. This is needed to construct `</span><span class="si">{0}</span><span class="s2">`</span>
<span class="s2">            to the requested `time` and thus populate the GeoDataFrame.</span>

<span class="s2">        Notes</span>
<span class="s2">        -----</span>
<span class="s2">        The `</span><span class="si">{0}</span><span class="s2">` needed to produce the GeoDataFrame are automatically</span>
<span class="s2">        constructed if the optional `time` parameter is passed to the</span>
<span class="s2">        `PlotTopologies` object before calling this function. `time` can be</span>
<span class="s2">        passed either when `PlotTopologies` is first called...</span>

<span class="s2">            gplot = gplately.PlotTopologies(..., time=100,...)</span>

<span class="s2">        or anytime afterwards, by setting:</span>

<span class="s2">            time = 100 # Ma</span>
<span class="s2">            gplot.time = time</span>

<span class="s2">        ...after which this function can be re-run. Once the `</span><span class="si">{0}</span><span class="s2">`</span>
<span class="s2">        are reconstructed, they are converted into Shapely lines whose</span>
<span class="s2">        coordinates are passed to a geopandas GeoDataFrame.</span>

<span class="s2">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="shapelify_features">
<a class="viewcode-back" href="../../gplately.html#gplately.shapelify_features">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">shapelify_features</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_shapelify_features</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>



<div class="viewcode-block" id="shapelify_feature_lines">
<a class="viewcode-back" href="../../gplately.html#gplately.shapelify_feature_lines">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">shapelify_feature_lines</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_shapelify_features</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>



<div class="viewcode-block" id="shapelify_feature_polygons">
<a class="viewcode-back" href="../../gplately.html#gplately.shapelify_feature_polygons">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">shapelify_feature_polygons</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_shapelify_features</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>



<div class="viewcode-block" id="plot_subduction_teeth">
<a class="viewcode-back" href="../../gplately.html#gplately.plot_subduction_teeth">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_subduction_teeth</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_plot_subduction_teeth</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>



<span class="n">plot_subduction_teeth</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_plot_subduction_teeth</span><span class="o">.</span><span class="vm">__doc__</span>
<span class="n">shapelify_features</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_shapelify_features</span><span class="o">.</span><span class="vm">__doc__</span>
<span class="n">shapelify_feature_lines</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_shapelify_features</span><span class="o">.</span><span class="vm">__doc__</span>
<span class="n">shapelify_feature_polygons</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_shapelify_features</span><span class="o">.</span><span class="vm">__doc__</span>


<div class="viewcode-block" id="PlotTopologies">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PlotTopologies</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class with tools to read, reconstruct and plot topology features at specific</span>
<span class="sd">    reconstruction times.</span>

<span class="sd">    `PlotTopologies` is a shorthand for PyGPlates and Shapely functionalities that:</span>

<span class="sd">    * Read features held in GPlates GPML (GPlates Markup Language) files and</span>
<span class="sd">    ESRI shapefiles;</span>
<span class="sd">    * Reconstruct the locations of these features as they migrate through</span>
<span class="sd">    geological time;</span>
<span class="sd">    * Turn these reconstructed features into Shapely geometries for plotting</span>
<span class="sd">    on `cartopy.mpl.geoaxes.GeoAxes` or `cartopy.mpl.geoaxes.GeoAxesSubplot` map</span>
<span class="sd">    Projections.</span>

<span class="sd">    To call the `PlotTopologies` object, supply:</span>

<span class="sd">    * an instance of the GPlately `plate_reconstruction` object</span>

<span class="sd">    and optionally,</span>

<span class="sd">    * a `coastline_filename`</span>
<span class="sd">    * a `continent_filename`</span>
<span class="sd">    * a `COB_filename`</span>
<span class="sd">    * a reconstruction `time`</span>
<span class="sd">    * an `anchor_plate_id`</span>

<span class="sd">    For example:</span>

<span class="sd">        # Calling the PlotTopologies object</span>
<span class="sd">        gplot = gplately.plot.PlotTopologies(plate_reconstruction,</span>
<span class="sd">                                            coastline_filename=None,</span>
<span class="sd">                                            continent_filename=None,</span>
<span class="sd">                                            COB_filename=None,</span>
<span class="sd">                                            time=None,</span>
<span class="sd">                                            anchor_plate_id=None,</span>
<span class="sd">                )</span>

<span class="sd">        # Setting a new reconstruction time</span>
<span class="sd">        gplot.time = 20 # Ma</span>

<span class="sd">    The `coastline_filename`, `continent_filename` and `COB_filename` can be single</span>
<span class="sd">    strings to GPML and/or shapefiles, as well as instances of `pygplates.FeatureCollection`.</span>
<span class="sd">    If using GPlately&#39;s `DataServer` object to source these files, they will be passed as</span>
<span class="sd">    `pygplates.FeatureCollection` items.</span>

<span class="sd">    Some features for plotting (like plate boundaries) are taken from the `PlateReconstruction`</span>
<span class="sd">    object&#39;s`topology_features` attribute. They have already been reconstructed to the given `time`.</span>
<span class="sd">    Simply provide a new reconstruction time by changing the `time` attribute, e.g.</span>

<span class="sd">        gplot.time = 20 # Ma</span>

<span class="sd">    which will automatically reconstruct all topologies to the specified time.</span>
<span class="sd">    You __MUST__ set `gplot.time` before plotting anything.</span>

<span class="sd">    A variety of geological features can be plotted on GeoAxes/GeoAxesSubplot maps</span>
<span class="sd">    as Shapely `MultiLineString` or `MultiPolygon` geometries, including:</span>

<span class="sd">    * subduction boundaries &amp; subduction polarity teeth</span>
<span class="sd">    * mid-ocean ridge boundaries</span>
<span class="sd">    * transform boundaries</span>
<span class="sd">    * miscellaneous boundaries</span>
<span class="sd">    * coastline polylines</span>
<span class="sd">    * continental polygons and</span>
<span class="sd">    * continent-ocean boundary polylines</span>
<span class="sd">    * topological plate velocity vector fields</span>
<span class="sd">    * netCDF4 MaskedArray or ndarray raster data:</span>
<span class="sd">        - seafloor age grids</span>
<span class="sd">        - paleo-age grids</span>
<span class="sd">        - global relief (topography and bathymetry)</span>
<span class="sd">    * assorted reconstructable feature data, for example:</span>
<span class="sd">        - seafloor fabric</span>
<span class="sd">        - large igneous provinces</span>
<span class="sd">        - volcanic provinces</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    plate_reconstruction : instance of &lt;gplately.reconstruction.PlateReconstruction&gt;</span>
<span class="sd">        The GPlately `PlateReconstruction` object will be used to access a plate</span>
<span class="sd">        `rotation_model` and a set of `topology_features` which contains plate boundary</span>
<span class="sd">        features like trenches, ridges and transforms.</span>

<span class="sd">    anchor_plate_id : int</span>
<span class="sd">        The anchor plate ID used for reconstruction.</span>
<span class="sd">        Defaults to the anchor plate of `plate_reconstruction`.</span>

<span class="sd">    base_projection : instance of &lt;cartopy.crs.{transform}&gt;, default &lt;cartopy.crs.PlateCarree&gt; object</span>
<span class="sd">        where {transform} is the map Projection to use on the Cartopy GeoAxes.</span>
<span class="sd">        By default, the base projection is set to cartopy.crs.PlateCarree. See the</span>
<span class="sd">        [Cartopy projection list](https://scitools.org.uk/cartopy/docs/v0.15/crs/projections.html)</span>
<span class="sd">        for all supported Projection types.</span>

<span class="sd">    coastlines : str, or instance of &lt;pygplates.FeatureCollection&gt;</span>
<span class="sd">        The full string path to a coastline feature file. Coastline features can also</span>
<span class="sd">        be passed as instances of the `pygplates.FeatureCollection` object (this is</span>
<span class="sd">        the case if these features are sourced from the `DataServer` object).</span>

<span class="sd">    continents : str, or instance of &lt;pygplates.FeatureCollection&gt;</span>
<span class="sd">        The full string path to a continent feature file. Continent features can also</span>
<span class="sd">        be passed as instances of the `pygplates.FeatureCollection` object (this is</span>
<span class="sd">        the case if these features are sourced from the `DataServer` object).</span>

<span class="sd">    COBs : str, or instance of &lt;pygplates.FeatureCollection&gt;</span>
<span class="sd">        The full string path to a COB feature file. COB features can also be passed</span>
<span class="sd">        as instances of the `pygplates.FeatureCollection` object (this is the case</span>
<span class="sd">        if these features are sourced from the `DataServer` object).</span>

<span class="sd">    coastlines : iterable/list of &lt;pygplates.ReconstructedFeatureGeometry&gt;</span>
<span class="sd">        A list containing coastline features reconstructed to the specified `time` attribute.</span>

<span class="sd">    continents : iterable/list of &lt;pygplates.ReconstructedFeatureGeometry&gt;</span>
<span class="sd">        A list containing continent features reconstructed to the specified `time` attribute.</span>

<span class="sd">    COBs : iterable/list of &lt;pygplates.ReconstructedFeatureGeometry&gt;</span>
<span class="sd">        A list containing COB features reconstructed to the specified `time` attribute.</span>

<span class="sd">    time : float</span>
<span class="sd">        The time (Ma) to reconstruct and plot geological features to.</span>

<span class="sd">    topologies : iterable/list of &lt;pygplates.Feature&gt;</span>
<span class="sd">        A list containing assorted topologies like:</span>

<span class="sd">        - pygplates.FeatureType.gpml_topological_network</span>
<span class="sd">        - pygplates.FeatureType.gpml_oceanic_crust</span>
<span class="sd">        - pygplates.FeatureType.gpml_topological_slab_boundary</span>
<span class="sd">        - pygplates.FeatureType.gpml_topological_closed_plate_boundary</span>

<span class="sd">    ridges : iterable/list of &lt;pygplates.Feature&gt;</span>
<span class="sd">        A list containing ridge and transform boundary sections of type</span>
<span class="sd">        pygplates.FeatureType.gpml_mid_ocean_ridge</span>

<span class="sd">    transforms : iterable/list of &lt;pygplates.Feature&gt;</span>
<span class="sd">        A list containing transform boundary sections of type pygplates.FeatureType.gpml_transforms</span>

<span class="sd">    trenches : iterable/list of &lt;pygplates.Feature&gt;</span>
<span class="sd">        A list containing trench boundary sections of type pygplates.FeatureType.gpml_subduction_zone</span>

<span class="sd">    trench_left : iterable/list of &lt;pygplates.Feature&gt;</span>
<span class="sd">        A list containing left subduction boundary sections of type pygplates.FeatureType.gpml_subduction_zone</span>

<span class="sd">    trench_right : iterable/list of &lt;pygplates.Feature&gt;</span>
<span class="sd">        A list containing right subduction boundary sections of type pygplates.FeatureType.gpml_subduction_zone</span>

<span class="sd">    other : iterable/list of &lt;pygplates.Feature&gt;</span>
<span class="sd">        A list containing other geological features like unclassified features, extended continental crusts,</span>
<span class="sd">        continental rifts, faults, orogenic belts, fracture zones, inferred paleo boundaries, terrane</span>
<span class="sd">        boundaries and passive continental boundaries.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PlotTopologies.__init__">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">plate_reconstruction</span><span class="p">,</span>
        <span class="n">coastlines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">continents</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">COBs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">anchor_plate_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">plot_engine</span><span class="p">:</span> <span class="n">PlotEngine</span> <span class="o">=</span> <span class="n">CartopyPlotEngine</span><span class="p">(),</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_engine</span> <span class="o">=</span> <span class="n">plot_engine</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span> <span class="o">=</span> <span class="n">plate_reconstruction</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">topology_features</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">topology_features</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Plate model does not have topology features.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">base_projection</span> <span class="o">=</span> <span class="n">DEFAULT_CARTOPY_PROJECTION</span>

        <span class="c1"># store these for when time is updated</span>
        <span class="c1"># make sure these are initialised as FeatureCollection objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coastlines</span> <span class="o">=</span> <span class="n">_load_FeatureCollection</span><span class="p">(</span><span class="n">coastlines</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_continents</span> <span class="o">=</span> <span class="n">_load_FeatureCollection</span><span class="p">(</span><span class="n">continents</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_COBs</span> <span class="o">=</span> <span class="n">_load_FeatureCollection</span><span class="p">(</span><span class="n">COBs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">coastlines</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">continents</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COBs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_topological_plate_boundaries</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_topologies</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ridges</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_transforms</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_engine</span> <span class="o">=</span> <span class="n">plot_engine</span>

        <span class="k">if</span> <span class="n">anchor_plate_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Default to the anchor plate of &#39;self.plate_reconstruction&#39;.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_anchor_plate_id</span><span class="p">(</span><span class="n">anchor_plate_id</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># setting time runs the update_time routine</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">time</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Arguments for __init__.</span>
        <span class="c1">#</span>
        <span class="c1"># Only one argument is required by __init__, and that&#39;s a PlateReconstruction object (which&#39;ll get pickled).</span>
        <span class="n">init_args</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="p">,)</span>

        <span class="c1"># State for __setstate__.</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Remove &#39;plate_reconstruction&#39; since that will get passed to __init__.</span>
        <span class="k">del</span> <span class="n">state</span><span class="p">[</span><span class="s2">&quot;plate_reconstruction&quot;</span><span class="p">]</span>

        <span class="c1"># Remove the unpicklable entries.</span>
        <span class="c1">#</span>
        <span class="c1"># This includes pygplates reconstructed feature geometries and resolved topological geometries.</span>
        <span class="c1"># Note: PyGPlates features and features collections (and rotation models) can be pickled though.</span>
        <span class="c1">#</span>
        <span class="c1"># __setstate__ will call &#39;update_time()&#39; to generate these reconstructed/resolved geometries/features.</span>
        <span class="c1"># So we don&#39;t need to pickle them.</span>
        <span class="c1"># Note: Some of them we can pickle (eg, &quot;resolved features&quot;, which are of type pygplates.Feature) and</span>
        <span class="c1">#       some we cannot (like &#39;coastlines&#39; which are of type pygplates.ReconstructedFeatureGeometry).</span>
        <span class="c1">#       However, as mentioned, we won&#39;t pickle any of them (since taken care of by &#39;update_time()&#39;).</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="s2">&quot;coastlines&quot;</span><span class="p">,</span>  <span class="c1"># we&#39;re keeping &quot;_coastlines&quot; though (we need the original &#39;pygplates.Feature&#39;s to reconstruct with)</span>
            <span class="s2">&quot;continents&quot;</span><span class="p">,</span>  <span class="c1"># we&#39;re keeping &quot;_continents&quot; though (we need the original &#39;pygplates.Feature&#39;s to reconstruct with)</span>
            <span class="s2">&quot;COBs&quot;</span><span class="p">,</span>  <span class="c1"># we&#39;re keeping &quot;_COBs&quot; though (we need the original &#39;pygplates.Feature&#39;s to reconstruct with)</span>
            <span class="s2">&quot;_topological_plate_boundaries&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_topologies&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_ridges&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_ridges_do_not_use_for_now&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_transforms&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_transforms_do_not_use_for_now&quot;</span><span class="p">,</span>
            <span class="s2">&quot;trenches&quot;</span><span class="p">,</span>
            <span class="s2">&quot;trench_left&quot;</span><span class="p">,</span>
            <span class="s2">&quot;trench_right&quot;</span><span class="p">,</span>
            <span class="s2">&quot;other&quot;</span><span class="p">,</span>
            <span class="s2">&quot;continental_rifts&quot;</span><span class="p">,</span>
            <span class="s2">&quot;faults&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fracture_zones&quot;</span><span class="p">,</span>
            <span class="s2">&quot;inferred_paleo_boundaries&quot;</span><span class="p">,</span>
            <span class="s2">&quot;terrane_boundaries&quot;</span><span class="p">,</span>
            <span class="s2">&quot;transitional_crusts&quot;</span><span class="p">,</span>
            <span class="s2">&quot;orogenic_belts&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sutures&quot;</span><span class="p">,</span>
            <span class="s2">&quot;continental_crusts&quot;</span><span class="p">,</span>
            <span class="s2">&quot;extended_continental_crusts&quot;</span><span class="p">,</span>
            <span class="s2">&quot;passive_continental_boundaries&quot;</span><span class="p">,</span>
            <span class="s2">&quot;slab_edges&quot;</span><span class="p">,</span>
            <span class="s2">&quot;unclassified_features&quot;</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">state</span><span class="p">:</span>  <span class="c1"># in case some state has not been initialised yet</span>
                <span class="k">del</span> <span class="n">state</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

        <span class="c1"># Call __init__ so that we default initialise everything in a consistent state before __setstate__ gets called.</span>
        <span class="c1"># Note that this is the reason we implement __reduce__, instead of __getstate__ (where __init__ doesn&#39;t get called).</span>
        <span class="c1">#</span>
        <span class="c1"># If we don&#39;t do this then __setstate__ would need to stay in sync with __init__ (whenever it gets updated).</span>
        <span class="k">return</span> <span class="n">PlotTopologies</span><span class="p">,</span> <span class="n">init_args</span><span class="p">,</span> <span class="n">state</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

        <span class="c1"># Restore the unpicklable entries.</span>
        <span class="c1">#</span>
        <span class="c1"># This includes pygplates reconstructed feature geometries and resolved topological geometries.</span>
        <span class="c1"># Note: PyGPlates features and features collections (and rotation models) can be pickled though.</span>
        <span class="c1">#</span>
        <span class="c1"># Re-generate the pygplates reconstructed feature geometries and resolved topological geometries</span>
        <span class="c1"># deleted from the state returned by __reduce__.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">topological_plate_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resolved topologies for rigid boundaries ONLY.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_topological_plate_boundaries</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">topologies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resolved topologies for BOTH rigid boundaries and networks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_topologies</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ridges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mid-ocean ridge features (all the features which are labelled as gpml:MidOceanRidge in the model).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;ridges&#39; property has been changed since GPlately 1.3.0. &quot;</span>
            <span class="s2">&quot;You need to check your workflow to make sure the new &#39;ridges&#39; property still suits your purpose. &quot;</span>
            <span class="s2">&quot;In earlier releases of GPlately, we used an algorithm to identify the &#39;ridges&#39; and &#39;transforms&#39; within the gpml:MidOceanRidge features. &quot;</span>
            <span class="s2">&quot;Unfortunately, the algorithm did not work very well. So we have removed the algorithm and now the &#39;ridges&#39; property contains all the features &quot;</span>
            <span class="s2">&quot;which are labelled as gpml:MidOceanRidge in the reconstruction model.&quot;</span>
        <span class="p">)</span>  <span class="c1"># use logger.debug to make the message less aggressive</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ridges</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transform boundary features (all the features which are labelled as gpml:Transform in the model).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;transforms&#39; property has been changed since GPlately 1.3.0. &quot;</span>
            <span class="s2">&quot;You need to check your workflow to make sure the new &#39;transforms&#39; property still suits your purpose. &quot;</span>
            <span class="s2">&quot;In earlier releases of GPlately, we used an algorithm to identify the &#39;ridges&#39; and &#39;transforms&#39; within the gpml:MidOceanRidge features. &quot;</span>
            <span class="s2">&quot;Unfortunately, the algorithm did not work very well. So we have removed the algorithm and now the &#39;transforms&#39; property contains all the features &quot;</span>
            <span class="s2">&quot;which are labelled as gpml:Transform in the reconstruction model.&quot;</span>
        <span class="p">)</span>  <span class="c1"># use logger.debug to make the message less aggressive</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transforms</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The reconstruction time.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span>

    <span class="nd">@time</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Allows the time attribute to be changed. Updates all instances of the time attribute in the object (e.g.</span>
<span class="sd">        reconstructions and resolving topologies will use this new time).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the chosen reconstruction time is &lt;0 Ma.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">var</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The &#39;time&#39; property must be greater than 0.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_time</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">anchor_plate_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Anchor plate ID for reconstruction. Must be an integer &gt;= 0.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Default to anchor plate of &#39;self.plate_reconstruction&#39;.</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">anchor_plate_id</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span>

    <span class="nd">@anchor_plate_id</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">anchor_plate_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">anchor_plate</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">anchor_plate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># We&#39;ll use the anchor plate of &#39;self.plate_reconstruction&#39;.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_anchor_plate_id</span><span class="p">(</span><span class="n">anchor_plate</span><span class="p">)</span>

        <span class="c1"># Reconstructed/resolved geometries depend on the anchor plate.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>

<div class="viewcode-block" id="PlotTopologies._check_anchor_plate_id">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies._check_anchor_plate_id">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_check_anchor_plate_id</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">id</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid anchor plate ID: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">id</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">id</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ridge_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deprecated! DO NOT USE!</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Deprecated! DO NOT USE!&quot;</span>
            <span class="s2">&quot;The &#39;ridge_transforms&#39; property will be removed in the future GPlately releases. &quot;</span>
            <span class="s2">&quot;Update your workflow to use the &#39;ridges&#39; and &#39;transforms&#39; properties instead, &quot;</span>
            <span class="s2">&quot;otherwise your workflow will not work with the future GPlately releases.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;ridge_transforms&#39; property has been changed since GPlately 1.3.0. &quot;</span>
            <span class="s2">&quot;You need to check your workflow to make sure the new &#39;ridge_transforms&#39; property still suits your purpose. &quot;</span>
            <span class="s2">&quot;In earlier releases of GPlately, the &#39;ridge_transforms&#39; property contains only the features &quot;</span>
            <span class="s2">&quot;which are labelled as gpml:MidOceanRidge in the reconstruction model. &quot;</span>
            <span class="s2">&quot;Now, the &#39;ridge_transforms&#39; property contains both gpml:Transform and gpml:MidOceanRidge features.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ridges</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transforms</span>

<div class="viewcode-block" id="PlotTopologies.update_time">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.update_time">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Re-reconstruct features and topologies to the time specified by the `PlotTopologies` `time` attribute</span>
<span class="sd">        whenever it or the anchor plate is updated.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The following `PlotTopologies` attributes are updated whenever a reconstruction `time` attribute is set:</span>

<span class="sd">        - resolved topology features (topological plates and networks)</span>
<span class="sd">        - ridge and transform boundary sections (resolved features)</span>
<span class="sd">        - ridge boundary sections (resolved features)</span>
<span class="sd">        - transform boundary sections (resolved features)</span>
<span class="sd">        - subduction boundary sections (resolved features)</span>
<span class="sd">        - left subduction boundary sections (resolved features)</span>
<span class="sd">        - right subduction boundary sections (resolved features)</span>
<span class="sd">        - other boundary sections (resolved features) that are not subduction zones or mid-ocean ridges</span>
<span class="sd">        (ridge/transform)</span>

<span class="sd">        Moreover, coastlines, continents and COBs are reconstructed to the new specified `time`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;time must be set to a valid reconstruction time&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>

        <span class="c1"># Get the topological snapshot (of resolved topologies) for the current time (and our anchor plate ID).</span>
        <span class="n">topological_snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">topological_snapshot</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
            <span class="c1"># If our anchor plate is None then this will use the anchor plate of &#39;self.plate_reconstruction&#39;...</span>
            <span class="n">anchor_plate_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1">#</span>
        <span class="c1"># NOTE: If you add a new data member here that&#39;s a pygplates reconstructable feature geometry or resolved topological geometry,</span>
        <span class="c1">#       then be sure to also include it in __getstate__/()__setstate__()</span>
        <span class="c1">#       (basically anything reconstructed or resolved by pygplates since those cannot be pickled).</span>
        <span class="c1">#</span>

        <span class="c1"># Extract (from the topological snapshot) resolved topologies for BOTH rigid boundaries and networks.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_topologies</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">t</span><span class="o">.</span><span class="n">get_resolved_feature</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">topological_snapshot</span><span class="o">.</span><span class="n">get_resolved_topologies</span><span class="p">(</span>
                <span class="n">resolve_topology_types</span><span class="o">=</span><span class="n">pygplates</span><span class="o">.</span><span class="n">ResolveTopologyType</span><span class="o">.</span><span class="n">boundary</span>
                <span class="o">|</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">ResolveTopologyType</span><span class="o">.</span><span class="n">network</span>
            <span class="p">)</span>
        <span class="p">]</span>

        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_topological_plate_boundaries</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ridges</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ridges_do_not_use_for_now</span><span class="p">,</span>  <span class="c1"># the algorithm to separate ridges and transforms has not been ready yet</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_transforms_do_not_use_for_now</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trenches</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trench_left</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trench_right</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">other</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="n">ptt</span><span class="o">.</span><span class="n">resolve_topologies</span><span class="o">.</span><span class="n">resolve_topological_snapshot_into_features</span><span class="p">(</span>
            <span class="n">topological_snapshot</span><span class="p">,</span>
            <span class="c1"># use ResolveTopologyType.boundary parameter to resolve rigid plate boundary only</span>
            <span class="c1"># because the Mid-ocean ridges(and transforms) should not contain lines from topological networks</span>
            <span class="n">resolve_topology_types</span><span class="o">=</span><span class="n">pygplates</span><span class="o">.</span><span class="n">ResolveTopologyType</span><span class="o">.</span><span class="n">boundary</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
        <span class="p">)</span>

        <span class="c1"># miscellaneous boundaries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">continental_rifts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">faults</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fracture_zones</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inferred_paleo_boundaries</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terrane_boundaries</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transitional_crusts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orogenic_belts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sutures</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">continental_crusts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extended_continental_crusts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">passive_continental_boundaries</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slab_edges</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unclassified_features</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_transforms</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">topol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">other</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_continental_rift</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">continental_rifts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_fault</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">faults</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_fracture_zone</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fracture_zones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span>
                <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_inferred_paleo_boundary</span>  <span class="c1"># type: ignore</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inferred_paleo_boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_terrane_boundary</span>  <span class="c1"># type: ignore</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">terrane_boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span>
                <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_transitional_crust</span>  <span class="c1"># type: ignore</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">transitional_crusts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_orogenic_belt</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">orogenic_belts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_suture</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sutures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_continental_crust</span>  <span class="c1"># type: ignore</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">continental_crusts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span>
                <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_extended_continental_crust</span>  <span class="c1"># type: ignore</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">extended_continental_crusts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span>
                <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_passive_continental_boundary</span>  <span class="c1"># type: ignore</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">passive_continental_boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_slab_edge</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">slab_edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_transform</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_transforms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span>
                <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_unclassified_feature</span>  <span class="c1"># type: ignore</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unclassified_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

        <span class="c1"># reconstruct other important polygons and lines</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coastlines</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coastlines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_coastlines</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                <span class="n">from_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="c1"># If our anchor plate is None then this will use the anchor plate of &#39;self.plate_reconstruction&#39;...</span>
                <span class="n">anchor_plate_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_continents</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">continents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_continents</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                <span class="n">from_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="c1"># If our anchor plate is None then this will use the anchor plate of &#39;self.plate_reconstruction&#39;...</span>
                <span class="n">anchor_plate_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_COBs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COBs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_COBs</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                <span class="n">from_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="c1"># If our anchor plate is None then this will use the anchor plate of &#39;self.plate_reconstruction&#39;...</span>
                <span class="n">anchor_plate_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span><span class="p">,</span>
            <span class="p">)</span></div>


    <span class="c1"># subduction teeth</span>
<div class="viewcode-block" id="PlotTopologies._tessellate_triangles">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies._tessellate_triangles">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">_tessellate_triangles</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">tesselation_radians</span><span class="p">,</span> <span class="n">triangle_base_length</span><span class="p">,</span> <span class="n">triangle_aspect</span><span class="o">=</span><span class="mf">1.0</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Places subduction teeth along subduction boundary line segments within a MultiLineString shapefile.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        shapefilename  : str</span>
<span class="sd">            Path to shapefile containing the subduction boundary features</span>

<span class="sd">        tesselation_radians : float</span>
<span class="sd">            Parametrises subduction teeth density. Triangles are generated only along line segments with distances</span>
<span class="sd">            that exceed the given threshold tessellation_radians.</span>

<span class="sd">        triangle_base_length : float</span>
<span class="sd">            Length of teeth triangle base</span>

<span class="sd">        triangle_aspect : float, default=1.0</span>
<span class="sd">            Aspect ratio of teeth triangles. Ratio is 1.0 by default.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        X_points : (n,3) array</span>
<span class="sd">            X points that define the teeth triangles</span>
<span class="sd">        Y_points : (n,3) array</span>
<span class="sd">            Y points that define the teeth triangles</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">tesselation_degrees</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">tesselation_radians</span><span class="p">)</span>
        <span class="n">triangle_pointsX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">triangle_pointsY</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">date_line_wrapper</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">DateLineWrapper</span><span class="p">()</span>  <span class="c1"># type: ignore</span>

        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">features</span><span class="p">:</span>
            <span class="n">cum_distance</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="k">for</span> <span class="n">geometry</span> <span class="ow">in</span> <span class="n">feature</span><span class="o">.</span><span class="n">get_geometries</span><span class="p">():</span>
                <span class="n">wrapped_lines</span> <span class="o">=</span> <span class="n">date_line_wrapper</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">geometry</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">wrapped_lines</span><span class="p">:</span>
                    <span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_longitude</span><span class="p">(),</span> <span class="n">p</span><span class="o">.</span><span class="n">get_latitude</span><span class="p">())</span>
                            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">get_points</span><span class="p">()</span>
                        <span class="p">]</span>
                    <span class="p">)</span>

                    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="n">A</span> <span class="o">=</span> <span class="n">pts</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>
                        <span class="n">B</span> <span class="o">=</span> <span class="n">pts</span><span class="p">[</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

                        <span class="n">AB_dist</span> <span class="o">=</span> <span class="n">B</span> <span class="o">-</span> <span class="n">A</span>
                        <span class="n">AB_norm</span> <span class="o">=</span> <span class="n">AB_dist</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="o">*</span><span class="n">AB_dist</span><span class="p">)</span>
                        <span class="n">cum_distance</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="o">*</span><span class="n">AB_dist</span><span class="p">)</span>

                        <span class="c1"># create a new triangle if cumulative distance is exceeded.</span>
                        <span class="k">if</span> <span class="n">cum_distance</span> <span class="o">&gt;=</span> <span class="n">tesselation_degrees</span><span class="p">:</span>
                            <span class="n">C</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">triangle_base_length</span> <span class="o">*</span> <span class="n">AB_norm</span>

                            <span class="c1"># find normal vector</span>
                            <span class="n">AD_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">AB_norm</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">AB_norm</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
                            <span class="n">AD_norm</span> <span class="o">=</span> <span class="n">AD_dist</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">AD_dist</span><span class="p">)</span>

                            <span class="n">C0</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">triangle_base_length</span> <span class="o">*</span> <span class="n">AB_norm</span>

                            <span class="c1"># project point along normal vector</span>
                            <span class="n">D</span> <span class="o">=</span> <span class="n">C0</span> <span class="o">+</span> <span class="n">triangle_base_length</span> <span class="o">*</span> <span class="n">triangle_aspect</span> <span class="o">*</span> <span class="n">AD_norm</span>

                            <span class="n">triangle_pointsX</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
                            <span class="n">triangle_pointsY</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

                            <span class="n">cum_distance</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">triangle_pointsX</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">triangle_pointsY</span><span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_feature">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_feature">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_feature</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">feature</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">validate_reconstruction_time</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed features.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The feature needed to produce the GeoDataFrame should already be constructed to a `time`.</span>
<span class="sd">        This function converts the feature into a set of Shapely geometries whose coordinates are</span>
<span class="sd">        passed to a geopandas GeoDataFrame.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        feature : instance of &lt;pygplates.Feature&gt;</span>
<span class="sd">            A feature reconstructed to `time`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gdf : instance of &lt;geopandas.GeoDataFrame&gt;</span>
<span class="sd">            A pandas.DataFrame that has a column with `feature` geometries.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">feature</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The &#39;feature&#39; parameter is None. Make sure a valid `feature` object has been provided.&quot;</span>
            <span class="p">)</span>
        <span class="n">shp</span> <span class="o">=</span> <span class="n">shapelify_features</span><span class="p">(</span>
            <span class="n">feature</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">({</span><span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="n">shp</span><span class="p">},</span> <span class="n">geometry</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>  <span class="c1"># type: ignore</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_feature">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_feature">[docs]</a>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_feature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot pygplates.FeatureCollection or pygplates.Feature onto a map.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">feature</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The given feature(</span><span class="si">{</span><span class="n">feature_name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">) in model:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">plate_model_name</span><span class="si">}</span><span class="s2"> is empty and will not be plotted.&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">ax</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;edgecolor&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;edgecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
            <span class="k">if</span> <span class="s2">&quot;facecolor&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;facecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_feature</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">,</span> <span class="n">feature</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies._plot_feature">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies._plot_feature">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">_plot_feature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">get_feature_func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;transform&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;&#39;transform&#39; keyword argument is ignored by PlotTopologies&quot;</span><span class="p">,</span>
                <span class="ne">UserWarning</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;transform&quot;</span><span class="p">)</span>
        <span class="n">tessellate_degrees</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;tessellate_degrees&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">central_meridian</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;central_meridian&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">central_meridian</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">central_meridian</span> <span class="o">=</span> <span class="n">_meridian_from_ax</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">get_feature_func</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The &#39;get_feature_func&#39; parameter must be callable.&quot;</span><span class="p">)</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">get_feature_func</span><span class="p">(</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Expecting a GeoDataFrame object, but the gdf is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;No feature found for plotting. Do nothing and return.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ax</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_engine</span><span class="o">.</span><span class="n">plot_geo_data_frame</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">gdf</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_coastlines">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_coastlines">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;coastlines&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_coastlines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed coastline polygons.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coastlines</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_coastlines">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_coastlines">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;coastlines&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_coastlines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot reconstructed coastline polygons onto a standard map Projection.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The `coastlines` for plotting are accessed from the `PlotTopologies` object&#39;s `coastlines` attribute.</span>
<span class="sd">        These `coastlines` are reconstructed to the `time` passed to the `PlotTopologies` object and converted into Shapely polylines.</span>
<span class="sd">        The reconstructed `coastlines` are added onto the GeoAxes or GeoAxesSubplot map `ax` using GeoPandas.</span>
<span class="sd">        Map resentation details (e.g. facecolor, edgecolor, alpha…) are permitted as keyword arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coastlines</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;coastlines&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_continents">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_continents">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;continents&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_continents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed continental polygons.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">continents</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_continents">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_continents">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;continents&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_continents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot reconstructed continental polygons onto a standard map Projection.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The `continents` for plotting are accessed from the `PlotTopologies` object&#39;s `continents` attribute.</span>
<span class="sd">        These `continents` are reconstructed to the `time` passed to the `PlotTopologies` object and converted into Shapely polygons.</span>
<span class="sd">        The reconstructed `coastlines` are plotted onto the GeoAxes or GeoAxesSubplot map `ax` using GeoPandas.</span>
<span class="sd">        Map presentation details (e.g. facecolor, edgecolor, alpha…) are permitted as keyword arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">continents</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;continents&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_continent_ocean_boundaries">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_continent_ocean_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;COBs&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_continent_ocean_boundaries</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed continent-ocean boundary lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COBs</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_continent_ocean_boundaries">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_continent_ocean_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;continent ocean boundaries&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_continent_ocean_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot reconstructed continent-ocean boundary (COB) polygons onto a standard map Projection.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The `COBs` for plotting are accessed from the `PlotTopologies` object&#39;s</span>
<span class="sd">        `COBs` attribute. These `COBs` are reconstructed to the `time`</span>
<span class="sd">        passed to the `PlotTopologies` object and converted into Shapely polylines.</span>
<span class="sd">        The reconstructed `COBs` are plotted onto the GeoAxes or GeoAxesSubplot map</span>
<span class="sd">        `ax` using GeoPandas. Map presentation details (e.g. `facecolor`, `edgecolor`, `alpha`…)</span>
<span class="sd">        are permitted as keyword arguments.</span>

<span class="sd">        These COBs are transformed into shapely geometries and added onto the chosen map for a specific geological time</span>
<span class="sd">        (supplied to the PlotTopologies object). Map presentation details (e.g. facecolor, edgecolor, alpha…) are permitted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COBs</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;continent_ocean_boundaries&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_ridges">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_ridges">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;ridges&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_ridges</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing the geometries of reconstructed mid-ocean ridge lines (gpml:MidOceanRidge).&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;get_ridges&#39; function has been changed since GPlately 1.3.0. &quot;</span>
            <span class="s2">&quot;You need to check your workflow to make sure the new &#39;get_ridges&#39; function still suits your purpose. &quot;</span>
            <span class="s2">&quot;In earlier releases of GPlately, we used an algorithm to identify the &#39;ridges&#39; and &#39;transforms&#39; within the gpml:MidOceanRidge features. &quot;</span>
            <span class="s2">&quot;Unfortunately, the algorithm did not work very well. So we have removed the algorithm and now the &#39;get_ridges&#39; function returns all the features &quot;</span>
            <span class="s2">&quot;which are labelled as gpml:MidOceanRidge in the reconstruction model.&quot;</span>
        <span class="p">)</span>  <span class="c1"># use logger.debug to make the message less aggressive</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ridges</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_ridges">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_ridges">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@validate_topology_availability</span><span class="p">(</span><span class="s2">&quot;ridges&quot;</span><span class="p">)</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;ridges&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_ridges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot reconstructed mid-ocean ridge lines(gpml:MidOceanRidge) onto a map.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The `ridges` sections for plotting are accessed from the</span>
<span class="sd">        `PlotTopologies` object&#39;s `ridges` attribute. These `ridges`</span>
<span class="sd">        are reconstructed to the `time` passed to the `PlotTopologies` object and converted</span>
<span class="sd">        into Shapely polylines. The reconstructed `ridges` are plotted onto the</span>
<span class="sd">        GeoAxes or GeoAxesSubplot map `ax` using GeoPandas. Map presentation details</span>
<span class="sd">        (e.g. `facecolor`, `edgecolor`, `alpha`…) are permitted as keyword arguments.</span>

<span class="sd">        Note: The `ridges` geometries are wrapped to the dateline using</span>
<span class="sd">        pyGPlates&#39; [DateLineWrapper](https://www.gplates.org/docs/pygplates/generated/pygplates.datelinewrapper)</span>
<span class="sd">        by splitting a polyline into multiple polylines at the dateline. This is to avoid</span>
<span class="sd">        horizontal lines being formed between polylines at longitudes of -180 and 180 degrees.</span>
<span class="sd">        Point features near the poles (-89 &amp; 89 degree latitude) are also clipped to ensure</span>
<span class="sd">        compatibility with Cartopy.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;plot_ridges&#39; function has been changed since GPlately 1.3.0. &quot;</span>
            <span class="s2">&quot;You need to check your workflow to make sure the new &#39;plot_ridges&#39; function still suits your purpose. &quot;</span>
            <span class="s2">&quot;In earlier releases of GPlately, we used an algorithm to identify the &#39;ridges&#39; and &#39;transforms&#39; within the gpml:MidOceanRidge features. &quot;</span>
            <span class="s2">&quot;Unfortunately, the algorithm did not work very well. So we have removed the algorithm and now the &#39;plot_ridges&#39; function plots all the features &quot;</span>
            <span class="s2">&quot;which are labelled as gpml:MidOceanRidge in the reconstruction model.&quot;</span>
        <span class="p">)</span>  <span class="c1"># use logger.debug to make the message less aggressive</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ridges</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;ridges&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_trenches">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_trenches">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;trenches&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_trenches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed trench lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trenches</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_ridges_and_transforms">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_ridges_and_transforms">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_ridges_and_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deprecated! DO NOT USE.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Deprecated! The &#39;get_ridges_and_transforms&#39; function will be removed in the future GPlately releases. &quot;</span>
            <span class="s2">&quot;Update your workflow to use the &#39;get_ridges&#39; and &#39;get_transforms&#39; functions instead, &quot;</span>
            <span class="s2">&quot;otherwise your workflow will not work with the future GPlately releases.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;get_ridges_and_transforms&#39; function has been changed since GPlately 1.3.0. &quot;</span>
            <span class="s2">&quot;You need to check your workflow to make sure the new &#39;get_ridges_and_transforms&#39; function still suits your purpose. &quot;</span>
            <span class="s2">&quot;In earlier releases of GPlately, we used an algorithm to identify the &#39;ridges&#39; and &#39;transforms&#39; within the gpml:MidOceanRidge features. &quot;</span>
            <span class="s2">&quot;Unfortunately, the algorithm did not work very well. So we have removed the algorithm and now the &#39;get_ridges_and_transforms&#39; function returns all the features &quot;</span>
            <span class="s2">&quot;which are labelled as gpml:MidOceanRidge or gpml:Transform in the reconstruction model.&quot;</span>
        <span class="p">)</span>  <span class="c1"># use logger.debug to make the message less aggressive</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ridges</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transforms</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_trenches">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_trenches">[docs]</a>
    <span class="nd">@validate_topology_availability</span><span class="p">(</span><span class="s2">&quot;trenches&quot;</span><span class="p">)</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;trenches&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_trenches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot reconstructed subduction trench polylines onto a standard map</span>
<span class="sd">        Projection.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The trench sections for plotting are accessed from the</span>
<span class="sd">        `PlotTopologies` object&#39;s `trenches` attribute. These `trenches`</span>
<span class="sd">        are reconstructed to the `time` passed to the `PlotTopologies` object and converted</span>
<span class="sd">        into Shapely polylines. The reconstructed `trenches` are plotted onto the</span>
<span class="sd">        GeoAxes or GeoAxesSubplot map `ax` using GeoPandas. Map presentation details</span>
<span class="sd">        (e.g. `facecolor`, `edgecolor`, `alpha`…) are permitted as keyword arguments.</span>

<span class="sd">        Trench geometries are wrapped to the dateline using</span>
<span class="sd">        pyGPlates&#39; [DateLineWrapper](https://www.gplates.org/docs/pygplates/generated/pygplates.datelinewrapper)</span>
<span class="sd">        by splitting a polyline into multiple polylines at the dateline. This is to avoid</span>
<span class="sd">        horizontal lines being formed between polylines at longitudes of -180 and 180 degrees.</span>
<span class="sd">        Point features near the poles (-89 &amp; 89 degree latitude) are also clipped to ensure</span>
<span class="sd">        compatibility with Cartopy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trenches</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;trenches&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_misc_boundaries">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_misc_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_misc_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of other reconstructed lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">other</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_misc_boundaries">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_misc_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_misc_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot reconstructed miscellaneous plate boundary polylines onto a standard</span>
<span class="sd">        map Projection.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The miscellaneous boundary sections for plotting are accessed from the</span>
<span class="sd">        `PlotTopologies` object&#39;s `other` attribute. These `other` boundaries</span>
<span class="sd">        are reconstructed to the `time` passed to the `PlotTopologies` object and converted</span>
<span class="sd">        into Shapely polylines. The reconstructed `other` boundaries are plotted onto the</span>
<span class="sd">        GeoAxes or GeoAxesSubplot map `ax` using GeoPandas. Map presentation details</span>
<span class="sd">        (e.g. `facecolor`, `edgecolor`, `alpha`…) are permitted as keyword arguments.</span>

<span class="sd">        Miscellaneous boundary geometries are wrapped to the dateline using</span>
<span class="sd">        pyGPlates&#39; [DateLineWrapper](https://www.gplates.org/docs/pygplates/generated/pygplates.datelinewrapper)</span>
<span class="sd">        by splitting a polyline into multiple polylines at the dateline. This is to avoid</span>
<span class="sd">        horizontal lines being formed between polylines at longitudes of -180 and 180 degrees.</span>
<span class="sd">        Point features near the poles (-89 &amp; 89 degree latitude) are also clipped to ensure</span>
<span class="sd">        compatibility with Cartopy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">other</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;misc_boundaries&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_subduction_teeth_deprecated">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_subduction_teeth_deprecated">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_subduction_teeth_deprecated</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot subduction teeth onto a standard map Projection.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Subduction teeth are tessellated from `PlotTopologies` object attributes `trench_left` and</span>
<span class="sd">        `trench_right`, and transformed into Shapely polygons for plotting.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax : instance of &lt;cartopy.mpl.geoaxes.GeoAxes&gt; or &lt;cartopy.mpl.geoaxes.GeoAxesSubplot&gt;</span>
<span class="sd">            A subclass of `matplotlib.axes.Axes` which represents a map Projection.</span>
<span class="sd">            The map should be set at a particular Cartopy projection.</span>

<span class="sd">        spacing : float, default=0.1</span>
<span class="sd">            The tessellation threshold (in radians). Parametrises subduction tooth density.</span>
<span class="sd">            Triangles are generated only along line segments with distances that exceed</span>
<span class="sd">            the given threshold ‘spacing’.</span>

<span class="sd">        size : float, default=2.0</span>
<span class="sd">            Length of teeth triangle base.</span>

<span class="sd">        aspect : float, default=1</span>
<span class="sd">            Aspect ratio of teeth triangles. Ratio is 1.0 by default.</span>

<span class="sd">        color : str, default=’black’</span>
<span class="sd">            The colour of the teeth. By default, it is set to black.</span>

<span class="sd">        **kwargs :</span>
<span class="sd">            Keyword arguments for parameters such as ‘alpha’, etc. for</span>
<span class="sd">            plotting subduction tooth polygons.</span>
<span class="sd">            See `Matplotlib` keyword arguments</span>
<span class="sd">            [here](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax : instance of &lt;geopandas.GeoDataFrame.plot&gt;</span>
<span class="sd">            A standard cartopy.mpl.geoaxes.GeoAxes or cartopy.mpl.geoaxes.GeoAxesSubplot map</span>
<span class="sd">            with subduction teeth plotted onto the chosen map projection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">shapely</span>

        <span class="c1"># add Subduction Teeth</span>
        <span class="n">subd_xL</span><span class="p">,</span> <span class="n">subd_yL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tessellate_triangles</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trench_left</span><span class="p">,</span>
            <span class="n">tesselation_radians</span><span class="o">=</span><span class="n">spacing</span><span class="p">,</span>
            <span class="n">triangle_base_length</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
            <span class="n">triangle_aspect</span><span class="o">=-</span><span class="n">aspect</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">subd_xR</span><span class="p">,</span> <span class="n">subd_yR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tessellate_triangles</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trench_right</span><span class="p">,</span>
            <span class="n">tesselation_radians</span><span class="o">=</span><span class="n">spacing</span><span class="p">,</span>
            <span class="n">triangle_base_length</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
            <span class="n">triangle_aspect</span><span class="o">=</span><span class="n">aspect</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">teeth</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">tX</span><span class="p">,</span> <span class="n">tY</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">subd_xL</span><span class="p">,</span> <span class="n">subd_yL</span><span class="p">):</span>
            <span class="n">triangle_xy_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">tX</span><span class="p">,</span> <span class="n">tY</span><span class="p">]</span>
            <span class="n">shp</span> <span class="o">=</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span><span class="n">triangle_xy_points</span><span class="p">)</span>
            <span class="n">teeth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shp</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">tX</span><span class="p">,</span> <span class="n">tY</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">subd_xR</span><span class="p">,</span> <span class="n">subd_yR</span><span class="p">):</span>
            <span class="n">triangle_xy_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">tX</span><span class="p">,</span> <span class="n">tY</span><span class="p">]</span>
            <span class="n">shp</span> <span class="o">=</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span><span class="n">triangle_xy_points</span><span class="p">)</span>
            <span class="n">teeth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shp</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_geometries</span><span class="p">(</span><span class="n">teeth</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">base_projection</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_subduction_direction">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_subduction_direction">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_subduction_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of trench directions.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The `trench_left` and `trench_right` geometries needed to produce the GeoDataFrame are automatically</span>
<span class="sd">        constructed if the optional `time` parameter is passed to the `PlotTopologies` object before calling</span>
<span class="sd">        this function. `time` can be passed either when `PlotTopologies` is first called...</span>

<span class="sd">            gplot = gplately.PlotTopologies(..., time=100,...)</span>

<span class="sd">        or anytime afterwards, by setting:</span>

<span class="sd">            time = 100 #Ma</span>
<span class="sd">            gplot.time = time</span>

<span class="sd">        ...after which this function can be re-run. Once the `other` geometries are reconstructed, they are</span>
<span class="sd">        converted into Shapely features whose coordinates are passed to a geopandas GeoDataFrame.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gdf_left : instance of &lt;geopandas.GeoDataFrame&gt;</span>
<span class="sd">            A pandas.DataFrame that has a column with `trench_left` geometry.</span>
<span class="sd">        gdf_right : instance of &lt;geopandas.GeoDataFrame&gt;</span>
<span class="sd">            A pandas.DataFrame that has a column with `trench_right` geometry.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the optional `time` parameter has not been passed to `PlotTopologies`. This is needed to construct</span>
<span class="sd">            `trench_left` or `trench_right` geometries to the requested `time` and thus populate the GeoDataFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trench_left</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">trench_right</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;No subduction zone/trench data is found. Make sure the plate model has topology feature.&quot;</span>
            <span class="p">)</span>

        <span class="n">trench_left_features</span> <span class="o">=</span> <span class="n">shapelify_feature_lines</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trench_left</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">trench_right_features</span> <span class="o">=</span> <span class="n">shapelify_feature_lines</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trench_right</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">gdf_left</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="n">trench_left_features</span><span class="p">},</span> <span class="n">geometry</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span>
        <span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">gdf_right</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="n">trench_right_features</span><span class="p">},</span> <span class="n">geometry</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span>
        <span class="p">)</span>  <span class="c1"># type: ignore</span>

        <span class="k">return</span> <span class="n">gdf_left</span><span class="p">,</span> <span class="n">gdf_right</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_subduction_teeth">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_subduction_teeth">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@validate_topology_availability</span><span class="p">(</span><span class="s2">&quot;Subduction Zones&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_subduction_teeth</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot subduction teeth onto a standard map Projection.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Subduction teeth are tessellated from `PlotTopologies` object attributes `trench_left` and</span>
<span class="sd">        `trench_right`, and transformed into Shapely polygons for plotting.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax : instance of &lt;cartopy.mpl.geoaxes.GeoAxes&gt; or &lt;cartopy.mpl.geoaxes.GeoAxesSubplot&gt;</span>
<span class="sd">            A subclass of `matplotlib.axes.Axes` which represents a map Projection.</span>
<span class="sd">            The map should be set at a particular Cartopy projection.</span>

<span class="sd">        spacing : float, default=0.07</span>
<span class="sd">            The tessellation threshold (in radians). Parametrises subduction tooth density.</span>
<span class="sd">            Triangles are generated only along line segments with distances that exceed</span>
<span class="sd">            the given threshold `spacing`.</span>

<span class="sd">        size : float, default=None</span>
<span class="sd">            Length of teeth triangle base (in radians). If kept at `None`, then</span>
<span class="sd">            `size = 0.5*spacing`.</span>

<span class="sd">        aspect : float, default=None</span>
<span class="sd">            Aspect ratio of teeth triangles. If kept at `None`, then `aspect = 2/3*size`.</span>

<span class="sd">        color : str, default=&#39;black&#39;</span>
<span class="sd">            The colour of the teeth. By default, it is set to black.</span>

<span class="sd">        **kwargs :</span>
<span class="sd">            Keyword arguments parameters such as `alpha`, etc.</span>
<span class="sd">            for plotting subduction tooth polygons.</span>
<span class="sd">            See `Matplotlib` keyword arguments</span>
<span class="sd">            [here](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;spacing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spacing</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">size</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;aspect&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">aspect</span>

        <span class="n">central_meridian</span> <span class="o">=</span> <span class="n">_meridian_from_ax</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">tessellate_degrees</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">spacing</span><span class="p">)</span>
        <span class="n">gdf_subduction_left</span><span class="p">,</span> <span class="n">gdf_subduction_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subduction_direction</span><span class="p">(</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_engine</span><span class="o">.</span><span class="n">plot_subduction_zones</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span> <span class="n">gdf_subduction_left</span><span class="p">,</span> <span class="n">gdf_subduction_right</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_plate_polygon_by_id">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_plate_polygon_by_id">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_plate_polygon_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">plate_id</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot a plate polygon with an associated `plate_id` onto a standard map Projection.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax : instance of &lt;cartopy.mpl.geoaxes.GeoAxes&gt; or &lt;cartopy.mpl.geoaxes.GeoAxesSubplot&gt;</span>
<span class="sd">            A subclass of `matplotlib.axes.Axes` which represents a map Projection.</span>
<span class="sd">            The map should be set at a particular Cartopy projection.</span>

<span class="sd">        plate_id : int</span>
<span class="sd">            A plate ID that identifies the continental polygon to plot. See the</span>
<span class="sd">            [Global EarthByte plate IDs list](https://www.earthbyte.org/webdav/ftp/earthbyte/GPlates/SampleData/FeatureCollections/Rotations/Global_EarthByte_PlateIDs_20071218.pdf)</span>
<span class="sd">            for a full list of plate IDs to plot.</span>

<span class="sd">        **kwargs :</span>
<span class="sd">            Keyword arguments for map presentation parameters such as</span>
<span class="sd">            `alpha`, etc. for plotting the grid.</span>
<span class="sd">            See `Matplotlib`&#39;s `imshow` keyword arguments</span>
<span class="sd">            [here](https://matplotlib.org/3.5.1/api/_as_gen/matplotlib.axes.Axes.imshow.html).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">features</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">topologies</span><span class="p">:</span>
            <span class="n">features</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">feature</span>
                    <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">topologies</span>
                    <span class="k">if</span> <span class="n">feature</span><span class="o">.</span><span class="n">get_reconstruction_plate_id</span><span class="p">()</span> <span class="o">==</span> <span class="n">plate_id</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="n">features</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_plate_id">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_plate_id">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_plate_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;TODO: remove this function</span>

<span class="sd">        The function name plot_plate_id() is bad and should be changed.</span>
<span class="sd">        The new name is plot_plate_polygon_by_id().</span>
<span class="sd">        For backward compatibility, we allow users to use the old name in their legcy code for now.</span>
<span class="sd">        No new code should call this function.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;The class method plot_plate_id is deprecated and will be removed in the future soon. Use plot_plate_polygon_by_id instead.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_plate_polygon_by_id</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_grid">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_grid">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot a `MaskedArray` raster or grid onto a standard map Projection.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Uses Matplotlib&#39;s `imshow`</span>
<span class="sd">        [function](https://matplotlib.org/3.5.1/api/_as_gen/matplotlib.axes.Axes.imshow.html).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax : instance of &lt;cartopy.mpl.geoaxes.GeoAxes&gt; or &lt;cartopy.mpl.geoaxes.GeoAxesSubplot&gt;</span>
<span class="sd">            A subclass of `matplotlib.axes.Axes` which represents a map Projection.</span>
<span class="sd">            The map should be set at a particular Cartopy projection.</span>

<span class="sd">        grid : MaskedArray or `gplately.grids.Raster`</span>
<span class="sd">            A `MaskedArray` with elements that define a grid. The number of rows in the raster</span>
<span class="sd">            corresponds to the number of latitudinal coordinates, while the number of raster</span>
<span class="sd">            columns corresponds to the number of longitudinal coordinates.</span>

<span class="sd">        extent : 1d array, default=[-180,180,-90,90]</span>
<span class="sd">            A four-element array to specify the [min lon, max lon, min lat, max lat] with</span>
<span class="sd">            which to constrain the grid image. If no extents are supplied, full global</span>
<span class="sd">            extent is assumed.</span>

<span class="sd">        **kwargs :</span>
<span class="sd">            Keyword arguments for map presentation parameters such as</span>
<span class="sd">            `alpha`, etc. for plotting the grid.</span>
<span class="sd">            See `Matplotlib`&#39;s `imshow` keyword arguments</span>
<span class="sd">            [here](https://matplotlib.org/3.5.1/api/_as_gen/matplotlib.axes.Axes.imshow.html).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax : instance of &lt;geopandas.GeoDataFrame.plot&gt;</span>
<span class="sd">            A standard cartopy.mpl.geoaxes.GeoAxes or cartopy.mpl.geoaxes.GeoAxesSubplot map</span>
<span class="sd">            with the grid plotted onto the chosen map projection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_engine</span><span class="p">,</span> <span class="n">CartopyPlotEngine</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Plotting grid has not been implemented for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_engine</span><span class="o">.</span><span class="vm">__class__</span><span class="si">}</span><span class="s2"> yet.&quot;</span>
            <span class="p">)</span>
        <span class="c1"># Override matplotlib default origin (&#39;upper&#39;)</span>
        <span class="n">origin</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;origin&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">)</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">.grids</span><span class="w"> </span><span class="kn">import</span> <span class="n">Raster</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">Raster</span><span class="p">):</span>
            <span class="c1"># extract extent and origin</span>
            <span class="n">extent</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">extent</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">origin</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">grid</span>

        <span class="k">return</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">base_projection</span><span class="p">,</span>
            <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_grid_from_netCDF">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_grid_from_netCDF">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_grid_from_netCDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read a raster from a netCDF file, convert it to a `MaskedArray` and plot it</span>
<span class="sd">        onto a standard map Projection.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        `plot_grid_from_netCDF` uses Matplotlib&#39;s `imshow`</span>
<span class="sd">        [function](https://matplotlib.org/3.5.1/api/_as_gen/matplotlib.axes.Axes.imshow.html).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax : instance of &lt;cartopy.mpl.geoaxes.GeoAxes&gt; or &lt;cartopy.mpl.geoaxes.GeoAxesSubplot&gt;</span>
<span class="sd">            A subclass of `matplotlib.axes.Axes` which represents a map Projection.</span>
<span class="sd">            The map should be set at a particular Cartopy projection.</span>

<span class="sd">        filename : str</span>
<span class="sd">            Full path to a netCDF filename.</span>

<span class="sd">        **kwargs :</span>
<span class="sd">            Keyword arguments for map presentation parameters for</span>
<span class="sd">            plotting the grid. See `Matplotlib`&#39;s `imshow` keyword arguments</span>
<span class="sd">            [here](https://matplotlib.org/3.5.1/api/_as_gen/matplotlib.axes.Axes.imshow.html).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax : instance of &lt;geopandas.GeoDataFrame.plot&gt;</span>
<span class="sd">            A standard cartopy.mpl.geoaxes.GeoAxes or cartopy.mpl.geoaxes.GeoAxesSubplot map</span>
<span class="sd">            with the netCDF grid plotted onto the chosen map projection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Override matplotlib default origin (&#39;upper&#39;)</span>
        <span class="n">origin</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;origin&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">)</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">.grids</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_netcdf_grid</span>

        <span class="n">raster</span><span class="p">,</span> <span class="n">lon_coords</span><span class="p">,</span> <span class="n">lat_coords</span> <span class="o">=</span> <span class="n">read_netcdf_grid</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">return_grids</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">lon_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lon_coords</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">lat_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_coords</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

        <span class="k">if</span> <span class="n">lon_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lat_coords</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="s2">&quot;lower&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="s2">&quot;upper&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">raster</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_plate_motion_vectors">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_plate_motion_vectors">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_plate_motion_vectors</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">spacingX</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">spacingY</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">normalise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate plate motion velocity vector fields at a particular geological time</span>
<span class="sd">        and plot them onto a standard map Projection.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        `plot_plate_motion_vectors` generates a MeshNode domain of point features using</span>
<span class="sd">        given spacings in the X and Y directions (`spacingX` and `spacingY`). Each point in</span>
<span class="sd">        the domain is assigned a plate ID, and these IDs are used to obtain equivalent stage</span>
<span class="sd">        rotations of identified tectonic plates over a 5 Ma time interval. Each point and</span>
<span class="sd">        its stage rotation are used to calculate plate velocities at a particular geological</span>
<span class="sd">        time. Velocities for each domain point are represented in the north-east-down</span>
<span class="sd">        coordinate system and plotted on a GeoAxes.</span>

<span class="sd">        Vector fields can be optionally normalised by setting `normalise` to `True`. This</span>
<span class="sd">        makes vector arrow lengths uniform.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax : instance of &lt;cartopy.mpl.geoaxes.GeoAxes&gt; or &lt;cartopy.mpl.geoaxes.GeoAxesSubplot&gt;</span>
<span class="sd">            A subclass of `matplotlib.axes.Axes` which represents a map Projection.</span>
<span class="sd">            The map should be set at a particular Cartopy projection.</span>

<span class="sd">        spacingX : int, default=10</span>
<span class="sd">            The spacing in the X direction used to make the velocity domain point feature mesh.</span>

<span class="sd">        spacingY : int, default=10</span>
<span class="sd">            The spacing in the Y direction used to make the velocity domain point feature mesh.</span>

<span class="sd">        normalise : bool, default=False</span>
<span class="sd">            Choose whether to normalise the velocity magnitudes so that vector lengths are</span>
<span class="sd">            all equal.</span>

<span class="sd">        **kwargs :</span>
<span class="sd">            Keyword arguments for quiver presentation parameters for plotting</span>
<span class="sd">            the velocity vector field. See `Matplotlib` quiver keyword arguments</span>
<span class="sd">            [here](https://matplotlib.org/3.5.1/api/_as_gen/matplotlib.axes.Axes.quiver.html).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ax : instance of &lt;geopandas.GeoDataFrame.plot&gt;</span>
<span class="sd">            A standard cartopy.mpl.geoaxes.GeoAxes or cartopy.mpl.geoaxes.GeoAxesSubplot map</span>
<span class="sd">            with the velocity vector field plotted onto the chosen map projection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_engine</span><span class="p">,</span> <span class="n">CartopyPlotEngine</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Plotting velocities has not been implemented for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_engine</span><span class="o">.</span><span class="vm">__class__</span><span class="si">}</span><span class="s2"> yet.&quot;</span>
            <span class="p">)</span>

        <span class="n">lonq</span><span class="p">,</span> <span class="n">latq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span> <span class="o">+</span> <span class="n">spacingX</span><span class="p">,</span> <span class="n">spacingX</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span> <span class="o">+</span> <span class="n">spacingY</span><span class="p">,</span> <span class="n">spacingY</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">lons</span> <span class="o">=</span> <span class="n">lonq</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">lats</span> <span class="o">=</span> <span class="n">latq</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

        <span class="n">delta_time</span> <span class="o">=</span> <span class="mf">5.0</span>

        <span class="n">velocity_lons</span><span class="p">,</span> <span class="n">velocity_lats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">get_point_velocities</span><span class="p">(</span>
            <span class="n">lons</span><span class="p">,</span>
            <span class="n">lats</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
            <span class="n">delta_time</span><span class="o">=</span><span class="n">delta_time</span><span class="p">,</span>
            <span class="c1"># Match previous implementation that used ptt.velocity_tools.get_plate_velocities()...</span>
            <span class="n">velocity_units</span><span class="o">=</span><span class="n">pygplates</span><span class="o">.</span><span class="n">VelocityUnits</span><span class="o">.</span><span class="n">kms_per_my</span><span class="p">,</span>
            <span class="n">return_east_north_arrays</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">normalise</span><span class="p">:</span>
            <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">velocity_lons</span><span class="p">,</span> <span class="n">velocity_lats</span><span class="p">)</span>
            <span class="n">mag</span><span class="p">[</span><span class="n">mag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">velocity_lons</span> <span class="o">/=</span> <span class="n">mag</span>
            <span class="n">velocity_lats</span> <span class="o">/=</span> <span class="n">mag</span>

        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
            <span class="n">quiver</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span>
                <span class="n">lons</span><span class="p">,</span>
                <span class="n">lats</span><span class="p">,</span>
                <span class="n">velocity_lons</span><span class="p">,</span>
                <span class="n">velocity_lats</span><span class="p">,</span>
                <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">base_projection</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">quiver</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_pole">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_pole">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_pole</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">a95</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot pole onto a matplotlib axes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax : instance of &lt;cartopy.mpl.geoaxes.GeoAxes&gt; or &lt;cartopy.mpl.geoaxes.GeoAxesSubplot&gt;</span>
<span class="sd">            A subclass of `matplotlib.axes.Axes` which represents a map Projection.</span>
<span class="sd">            The map should be set at a particular Cartopy projection.</span>

<span class="sd">        lon : float</span>
<span class="sd">            Longitudinal coordinate to place pole</span>
<span class="sd">        lat : float</span>
<span class="sd">            Latitudinal coordinate to place pole</span>
<span class="sd">        a95 : float</span>
<span class="sd">            The size of the pole (in degrees)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        matplotlib.patches.Circle handle</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">patches</span> <span class="k">as</span> <span class="n">mpatches</span>

        <span class="c1"># Define the projection used to display the circle:</span>
        <span class="n">proj1</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Orthographic</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=</span><span class="n">lat</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">compute_radius</span><span class="p">(</span><span class="n">ortho</span><span class="p">,</span> <span class="n">radius_degrees</span><span class="p">):</span>
            <span class="n">phi1</span> <span class="o">=</span> <span class="n">lat</span> <span class="o">+</span> <span class="n">radius_degrees</span> <span class="k">if</span> <span class="n">lat</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">lat</span> <span class="o">-</span> <span class="n">radius_degrees</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">ortho</span><span class="o">.</span><span class="n">transform_point</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">phi1</span><span class="p">,</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
            <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span>

        <span class="n">r_ortho</span> <span class="o">=</span> <span class="n">compute_radius</span><span class="p">(</span><span class="n">proj1</span><span class="p">,</span> <span class="n">a95</span><span class="p">)</span>

        <span class="c1"># adding a patch</span>
        <span class="n">patch</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">mpatches</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">),</span> <span class="n">radius</span><span class="o">=</span><span class="n">r_ortho</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">proj1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">patch</span></div>


<div class="viewcode-block" id="PlotTopologies.get_continental_rifts">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_continental_rifts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;continental rifts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_continental_rifts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed contiental rift lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">continental_rifts</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_continental_rifts">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_continental_rifts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;continental rifts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_continental_rifts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot continental rifts on a standard map projection.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">continental_rifts</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;continental_rifts&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_faults">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_faults">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;faults&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_faults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed fault lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">faults</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_faults">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_faults">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;faults&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_faults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot faults on a standard map projection.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">faults</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;faults&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_fracture_zones">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_fracture_zones">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;fracture zones&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_fracture_zones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed fracture zone lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fracture_zones</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_fracture_zones">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_fracture_zones">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;fracturezones&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_fracture_zones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot fracture zones on a standard map projection.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fracture_zones</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;fracture_zones&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_inferred_paleo_boundaries">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_inferred_paleo_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;inferred paleo-boundaries&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_inferred_paleo_boundaries</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed inferred paleo boundary lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inferred_paleo_boundaries</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_inferred_paleo_boundaries">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_inferred_paleo_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;inferred paleo-boundaries&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_inferred_paleo_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot inferred paleo boundaries on a standard map projection.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inferred_paleo_boundaries</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;inferred_paleo_boundaries&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_terrane_boundaries">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_terrane_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;terrane boundaries&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_terrane_boundaries</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed terrane boundary lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">terrane_boundaries</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_terrane_boundaries">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_terrane_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;terrane boundaries&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_terrane_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot terrane boundaries on a standard map projection.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">terrane_boundaries</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;terrane_boundaries&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_transitional_crusts">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_transitional_crusts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;transitional crusts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_transitional_crusts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed transitional crust lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transitional_crusts</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_transitional_crusts">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_transitional_crusts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;transitional crusts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_transitional_crusts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot transitional crust on a standard map projection.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transitional_crusts</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;transitional_crusts&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_orogenic_belts">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_orogenic_belts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;orogenic belts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_orogenic_belts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed orogenic belt lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">orogenic_belts</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_orogenic_belts">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_orogenic_belts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;orogenic belts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_orogenic_belts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot orogenic belts on a standard map projection.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">orogenic_belts</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;orogenic_belts&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_sutures">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_sutures">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;sutures&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_sutures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed suture lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sutures</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_sutures">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_sutures">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;sutures&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_sutures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot sutures on a standard map projection.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sutures</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;sutures&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_continental_crusts">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_continental_crusts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;continental crusts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_continental_crusts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed continental crust lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">continental_crusts</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_continental_crusts">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_continental_crusts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;continental crusts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_continental_crusts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot continental crust lines on a standard map projection.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">continental_crusts</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;continental_crusts&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_extended_continental_crusts">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_extended_continental_crusts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;extended continental crusts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_extended_continental_crusts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed extended continental crust lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extended_continental_crusts</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_extended_continental_crusts">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_extended_continental_crusts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;extended continental crusts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_extended_continental_crusts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot extended continental crust lines on a standard map projection.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extended_continental_crusts</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;extended_continental_crusts&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_passive_continental_boundaries">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_passive_continental_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;passive continental boundaries&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_passive_continental_boundaries</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed passive continental boundary lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">passive_continental_boundaries</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_passive_continental_boundaries">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_passive_continental_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;passive continental boundaries&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_passive_continental_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot passive continental boundaries on a standard map projection.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">passive_continental_boundaries</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;passive_continental_boundaries&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_slab_edges">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_slab_edges">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;slab edges&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_slab_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed slab edge lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slab_edges</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_slab_edges">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_slab_edges">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;slab edges&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_slab_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot slab edges on a standard map projection.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slab_edges</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;slab_edges&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_transforms">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_transforms">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;transforms&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_transforms</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed transform lines(gpml:Transform).&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;get_transforms&#39; function has been changed since GPlately 1.3.0. &quot;</span>
            <span class="s2">&quot;You need to check your workflow to make sure the new &#39;get_transforms&#39; function still suits your purpose. &quot;</span>
            <span class="s2">&quot;In earlier releases of GPlately, we used an algorithm to identify the &#39;ridges&#39; and &#39;transforms&#39; within the gpml:MidOceanRidge features. &quot;</span>
            <span class="s2">&quot;Unfortunately, the algorithm did not work very well. So we have removed the algorithm and now the &#39;get_transforms&#39; function returns all the features &quot;</span>
            <span class="s2">&quot;which are labelled as gpml:Transform in the reconstruction model.&quot;</span>
        <span class="p">)</span>  <span class="c1"># use logger.debug to make the message less aggressive</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_transforms</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_transforms">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_transforms">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;transforms&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot transform boundaries(gpml:Transform) onto a map.&quot;&quot;&quot;</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;plot_transforms&#39; function has been changed since GPlately 1.3.0. &quot;</span>
            <span class="s2">&quot;You need to check your workflow to make sure the new &#39;plot_transforms&#39; function still suits your purpose. &quot;</span>
            <span class="s2">&quot;In earlier releases of GPlately, we used an algorithm to identify the &#39;ridges&#39; and &#39;transforms&#39; within the gpml:MidOceanRidge features. &quot;</span>
            <span class="s2">&quot;Unfortunately, the algorithm did not work very well. So we have removed the algorithm and now the &#39;plot_transforms&#39; function plots all the features &quot;</span>
            <span class="s2">&quot;which are labelled as gpml:Transform in the reconstruction model.&quot;</span>
        <span class="p">)</span>  <span class="c1"># use logger.debug to make the message less aggressive</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_transforms</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;transforms&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_ridges_and_transforms">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_ridges_and_transforms">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_ridges_and_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deprecated! DO NOT USE!</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Deprecated! The &#39;plot_ridges_and_transforms&#39; function will be removed in the future GPlately releases. &quot;</span>
            <span class="s2">&quot;Update your workflow to use the &#39;plot_ridges&#39; and &#39;plot_transforms&#39; functions instead, &quot;</span>
            <span class="s2">&quot;otherwise your workflow will not work with the future GPlately releases.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;plot_ridges_and_transforms&#39; function has been changed since GPlately 1.3.0. &quot;</span>
            <span class="s2">&quot;You need to check your workflow to make sure the new &#39;plot_ridges_and_transforms&#39; function still suits your purpose. &quot;</span>
            <span class="s2">&quot;In earlier releases of GPlately, we used an algorithm to identify the &#39;ridges&#39; and &#39;transforms&#39; within the gpml:MidOceanRidge features. &quot;</span>
            <span class="s2">&quot;Unfortunately, the algorithm did not work very well. So we have removed the algorithm and now the &#39;plot_ridges_and_transforms&#39; function plots all the features &quot;</span>
            <span class="s2">&quot;which are labelled as gpml:Transform or gpml:MidOceanRidge in the reconstruction model.&quot;</span>
        <span class="p">)</span>  <span class="c1"># use logger.debug to make the message less aggressive</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ridges</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_transforms</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_unclassified_features">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_unclassified_features">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;unclassified features&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_unclassified_features</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed unclassified feature lines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unclassified_features</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_unclassified_features">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_unclassified_features">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;unclassified features&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_unclassified_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot GPML unclassified features on a standard map projection.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unclassified_features</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;unclassified_features&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_all_topologies">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_all_topologies">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;topologies&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_all_topologies</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed unclassified feature lines.&quot;&quot;&quot;</span>

        <span class="c1"># get plate IDs and feature types to add to geodataframe</span>
        <span class="n">plate_IDs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">feature_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">all_topologies</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">topologies</span><span class="p">:</span>
            <span class="n">all_topologies</span> <span class="o">=</span> <span class="n">shapelify_features</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">topologies</span><span class="p">,</span>
                <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
                <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">topo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">topologies</span><span class="p">:</span>
                <span class="n">ft_type</span> <span class="o">=</span> <span class="n">topo</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span>

                <span class="n">plate_IDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">get_reconstruction_plate_id</span><span class="p">())</span>
                <span class="n">feature_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ft_type</span><span class="p">)</span>
                <span class="n">feature_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ft_type</span><span class="o">.</span><span class="n">get_name</span><span class="p">())</span>

        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="n">all_topologies</span><span class="p">,</span>
                <span class="s2">&quot;reconstruction_plate_ID&quot;</span><span class="p">:</span> <span class="n">plate_IDs</span><span class="p">,</span>
                <span class="s2">&quot;feature_type&quot;</span><span class="p">:</span> <span class="n">feature_types</span><span class="p">,</span>
                <span class="s2">&quot;feature_name&quot;</span><span class="p">:</span> <span class="n">feature_names</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">geometry</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span>
        <span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="k">return</span> <span class="n">gdf</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_all_topologies">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_all_topologies">[docs]</a>
    <span class="nd">@validate_topology_availability</span><span class="p">(</span><span class="s2">&quot;all topologies&quot;</span><span class="p">)</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;topologies&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_all_topologies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot topological polygons and networks on a standard map projection.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;edgecolor&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;edgecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
        <span class="k">if</span> <span class="s2">&quot;facecolor&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;facecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_all_topologies</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_all_topological_sections">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_all_topological_sections">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;topologies&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_all_topological_sections</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of resolved topological sections.&quot;&quot;&quot;</span>

        <span class="c1"># get plate IDs and feature types to add to geodataframe</span>
        <span class="n">geometries</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">plate_IDs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">feature_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">topo</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ridges</span><span class="p">,</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">trenches</span><span class="p">,</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">trench_left</span><span class="p">,</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">trench_right</span><span class="p">,</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">other</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">converted</span> <span class="o">=</span> <span class="n">shapelify_features</span><span class="p">(</span>
                <span class="n">topo</span><span class="p">,</span>
                <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
                <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">converted</span><span class="p">,</span> <span class="n">BaseGeometry</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">converted</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">converted</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">BaseMultipartGeometry</span><span class="p">):</span>
                            <span class="n">tmp</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">geoms</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="n">converted</span> <span class="o">=</span> <span class="n">tmp</span>
                    <span class="k">del</span> <span class="n">tmp</span>
                    <span class="n">converted</span> <span class="o">=</span> <span class="n">linemerge</span><span class="p">(</span><span class="n">converted</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">converted</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">converted</span> <span class="o">=</span> <span class="n">converted</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="n">geometries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">converted</span><span class="p">)</span>
            <span class="n">plate_IDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">get_reconstruction_plate_id</span><span class="p">())</span>
            <span class="n">feature_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">())</span>
            <span class="n">feature_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">get_name</span><span class="p">())</span>

        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="n">geometries</span><span class="p">,</span>
                <span class="s2">&quot;reconstruction_plate_ID&quot;</span><span class="p">:</span> <span class="n">plate_IDs</span><span class="p">,</span>
                <span class="s2">&quot;feature_type&quot;</span><span class="p">:</span> <span class="n">feature_types</span><span class="p">,</span>
                <span class="s2">&quot;feature_name&quot;</span><span class="p">:</span> <span class="n">feature_names</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">geometry</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span>
        <span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="k">return</span> <span class="n">gdf</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_all_topological_sections">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_all_topological_sections">[docs]</a>
    <span class="nd">@validate_topology_availability</span><span class="p">(</span><span class="s2">&quot;all topological sections&quot;</span><span class="p">)</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;topologies&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_all_topological_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot all topologies on a standard map projection.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_all_topological_sections</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_topological_plate_boundaries">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_topological_plate_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;topological plate boundaries&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_topological_plate_boundaries</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a geopandas.GeoDataFrame object containing geometries of reconstructed rigid topological plate boundaries.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_topological_plate_boundaries</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_topological_plate_boundaries">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_topological_plate_boundaries">[docs]</a>
    <span class="nd">@validate_topology_availability</span><span class="p">(</span><span class="s2">&quot;topological plate boundaries&quot;</span><span class="p">)</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;topological plate boundaries&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_topological_plate_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_topological_plate_boundaries</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;topological plate boundaries&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">misc_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deprecated! DO NOT USE.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Deprecated! The &#39;misc_transforms&#39; property will be removed in the future GPlately releases. &quot;</span>
            <span class="s2">&quot;Update your workflow to use the &#39;transforms&#39; property instead, &quot;</span>
            <span class="s2">&quot;otherwise your workflow will not work with the future GPlately releases.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transforms</span>

<div class="viewcode-block" id="PlotTopologies.plot_misc_transforms">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.plot_misc_transforms">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_misc_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deprecated! DO NOT USE.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Deprecated! The &#39;plot_misc_transforms&#39; function will be removed in the future GPlately releases. &quot;</span>
            <span class="s2">&quot;Update your workflow to use the &#39;plot_transforms&#39; function instead, &quot;</span>
            <span class="s2">&quot;otherwise your workflow will not work with the future GPlately releases.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_transforms</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_misc_transforms">
<a class="viewcode-back" href="../../gplately.html#gplately.PlotTopologies.get_misc_transforms">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_misc_transforms</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deprecated! DO NOT USE.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Deprecated! The &#39;get_misc_transforms&#39; function will be removed in the future GPlately releases. &quot;</span>
            <span class="s2">&quot;Update your workflow to use the &#39;get_transforms&#39; function instead, &quot;</span>
            <span class="s2">&quot;otherwise your workflow will not work with the future GPlately releases.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transforms</span><span class="p">(</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span>
        <span class="p">)</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2025, The University of Sydney.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>