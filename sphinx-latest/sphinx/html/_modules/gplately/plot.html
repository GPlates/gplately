

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>gplately.plot &mdash; gplately 2.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=51b770b3"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            gplately
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../basic_usages.html">Minimal Working Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../use_cases.html">Common Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Troubleshooting and FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../command_line_interface.html">Command Line Interface (CLI)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">Main Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../secondaries.html">Other Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plate_models.html">Plate Models</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">gplately</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">gplately.plot</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for gplately.plot</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">#    Copyright (C) 2024-2026 The University of Sydney, Australia</span>
<span class="c1">#</span>
<span class="c1">#    This program is free software; you can redistribute it and/or modify it under</span>
<span class="c1">#    the terms of the GNU General Public License, version 2, as published by</span>
<span class="c1">#    the Free Software Foundation.</span>
<span class="c1">#</span>
<span class="c1">#    This program is distributed in the hope that it will be useful, but WITHOUT</span>
<span class="c1">#    ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span>
<span class="c1">#    FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License</span>
<span class="c1">#    for more details.</span>
<span class="c1">#</span>
<span class="c1">#    You should have received a copy of the GNU General Public License along</span>
<span class="c1">#    with this program; if not, write to Free Software Foundation, Inc.,</span>
<span class="c1">#    51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.</span>
<span class="c1">#</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This sub-module contains tools for reconstructing and plotting geological features and feature data through time.</span>

<span class="sd">Methods in `plot.py` reconstruct geological features using</span>
<span class="sd">`pyGPlates&#39; reconstruct function &lt;https://www.gplates.org/docs/pygplates/generated/pygplates.reconstruct.html&gt;__,</span>
<span class="sd">turns them into plottable Shapely geometries, and plots them onto Cartopy GeoAxes using Shapely and GeoPandas.</span>

<span class="sd">Classes</span>
<span class="sd">-------</span>
<span class="sd">PlotTopologies</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Union</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pygplates</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shapely</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseGeometry</span><span class="p">,</span> <span class="n">BaseMultipartGeometry</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.ops</span><span class="w"> </span><span class="kn">import</span> <span class="n">linemerge</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">ptt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">append_docstring</span><span class="p">,</span>
    <span class="n">validate_reconstruction_time</span><span class="p">,</span>
    <span class="n">validate_topology_availability</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.gpml</span><span class="w"> </span><span class="kn">import</span> <span class="n">_load_FeatureCollection</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.grids</span><span class="w"> </span><span class="kn">import</span> <span class="n">Raster</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.mapping.cartopy_plot</span><span class="w"> </span><span class="kn">import</span> <span class="n">DEFAULT_CARTOPY_PROJECTION</span><span class="p">,</span> <span class="n">CartopyPlotEngine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.mapping.plot_engine</span><span class="w"> </span><span class="kn">import</span> <span class="n">PlotEngine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">EARTH_RADIUS</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.utils.feature_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">shapelify_features</span> <span class="k">as</span> <span class="n">_shapelify_features</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.utils.plot_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">_meridian_from_ax</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.utils.plot_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_subduction_teeth</span> <span class="k">as</span> <span class="n">_plot_subduction_teeth</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;gplately&quot;</span><span class="p">)</span>

<span class="n">PLOT_DOCSTRING</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">             </span>
<span class="s2">Parameters</span>
<span class="s2">----------</span>
<span class="s2">ax :  </span>
<span class="s2">    Cartopy ax or pygmt figure object</span>

<span class="s2">color : str, default=&#39;black&#39;</span>
<span class="s2">    The edge colour of the geometries.</span>

<span class="s2">**kwargs :</span>
<span class="s2">    `Matplotlib keyword arguments &lt;https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html&gt;`__ or pygmt arguments</span>
<span class="s2">        </span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">GET_DATE_DOCSTRING</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>

<span class="s2">Parameters</span>
<span class="s2">----------</span>
<span class="s2">central_meridian : float, default=0.0</span>
<span class="s2">    The central meridian of the map. This will affect the dateline wrapping.</span>
<span class="s2">tessellate_degrees : float or None, default=1.0</span>
<span class="s2">    If provided, geometries will be tessellated to this resolution prior to wrapping.</span>

<span class="s2">Returns</span>
<span class="s2">-------</span>
<span class="s2">`geopandas.GeoDataFrame`_</span>
<span class="s2">    A `geopandas.GeoDataFrame`_ object containing the reconstructed **</span><span class="si">{0}</span><span class="s2">** geometries. The geometry column name is &quot;geometry&quot;.</span>
<span class="s2">&quot;&quot;&quot;</span>


<span class="k">def</span><span class="w"> </span><span class="nf">shapelify_features</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_shapelify_features</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">shapelify_feature_lines</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_shapelify_features</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">shapelify_feature_polygons</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_shapelify_features</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">plot_subduction_teeth</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_plot_subduction_teeth</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="n">plot_subduction_teeth</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_plot_subduction_teeth</span><span class="o">.</span><span class="vm">__doc__</span>
<span class="n">shapelify_features</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_shapelify_features</span><span class="o">.</span><span class="vm">__doc__</span>
<span class="n">shapelify_feature_lines</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_shapelify_features</span><span class="o">.</span><span class="vm">__doc__</span>
<span class="n">shapelify_feature_polygons</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_shapelify_features</span><span class="o">.</span><span class="vm">__doc__</span>


<div class="viewcode-block" id="PlotTopologies">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PlotTopologies</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read, reconstruct and plot topology features at specific reconstruction times.</span>

<span class="sd">    The :class:`PlotTopologies` class:</span>

<span class="sd">    * Read features held in GPlates GPML (GPlates Markup Language) files and ESRI shapefiles.</span>
<span class="sd">    * Reconstruct the locations of these features as they migrate through geological time.</span>
<span class="sd">    * Turn these reconstructed features into Shapely geometries for plotting.</span>

<span class="sd">    To create the :class:`PlotTopologies` object, supply:</span>

<span class="sd">    * an instance of the :class:`PlateReconstruction` object</span>

<span class="sd">    and optionally,</span>

<span class="sd">    * a coastline_filename</span>
<span class="sd">    * a continent_filename</span>
<span class="sd">    * a COB_filename</span>
<span class="sd">    * a reconstruction time</span>
<span class="sd">    * an anchor_plate_id</span>

<span class="sd">    For example:</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :linenos:</span>

<span class="sd">        # create a PlotTopologies object</span>
<span class="sd">        gplot = gplately.plot.PlotTopologies(</span>
<span class="sd">            plate_reconstruction,</span>
<span class="sd">            coastline_filename=None,</span>
<span class="sd">            continent_filename=None,</span>
<span class="sd">            COB_filename=None,</span>
<span class="sd">            time=100,</span>
<span class="sd">            anchor_plate_id=None,</span>
<span class="sd">        )</span>

<span class="sd">        # Setting a new reconstruction time</span>
<span class="sd">        gplot.time = 20  # Ma</span>

<span class="sd">    The ``coastline_filename``, ``continent_filename`` and ``COB_filename`` can be paths (:class:`str`) to GPML and/or shapefiles,</span>
<span class="sd">    as well as instances of `pygplates.FeatureCollection`_.</span>

<span class="sd">    Some features for plotting (like plate boundaries) are taken from the :attr:`PlateReconstruction.topology_features`.</span>
<span class="sd">    They have already been reconstructed to the given ``time``.</span>
<span class="sd">    Simply provide a new reconstruction time by changing the ``time`` attribute, e.g.</span>

<span class="sd">    .. code-block:: python</span>
<span class="sd">        :linenos:</span>

<span class="sd">        gplot.time = 20 # Ma</span>

<span class="sd">    which will automatically reconstruct all topologies to the specified time.</span>
<span class="sd">    You **MUST** set ``gplot.time`` before plotting anything.</span>

<span class="sd">    A variety of geological features can be plotted on maps, including:</span>

<span class="sd">    * subduction boundaries &amp; subduction polarity teeth</span>
<span class="sd">    * mid-ocean ridge boundaries</span>
<span class="sd">    * transform boundaries</span>
<span class="sd">    * miscellaneous boundaries</span>
<span class="sd">    * coastline polylines</span>
<span class="sd">    * continental polygons and</span>
<span class="sd">    * continent-ocean boundary polylines</span>
<span class="sd">    * topological plate velocity vector fields</span>
<span class="sd">    * netCDF4 `MaskedArray`_ or ndarray raster data:</span>
<span class="sd">        - seafloor age grids</span>
<span class="sd">        - paleo-age grids</span>
<span class="sd">        - global relief (topography and bathymetry)</span>
<span class="sd">    * assorted reconstructable feature data, for example:</span>
<span class="sd">        - seafloor fabric</span>
<span class="sd">        - large igneous provinces</span>
<span class="sd">        - volcanic provinces</span>

<span class="sd">    .. _pygplates.Feature: https://www.gplates.org/docs/pygplates/generated/pygplates.feature#pygplates.Feature</span>
<span class="sd">    .. _pygplates.ReconstructedFeatureGeometry: https://www.gplates.org/docs/pygplates/generated/pygplates.reconstructedfeaturegeometry</span>
<span class="sd">    .. _geopandas.GeoDataFrame: https://geopandas.org/en/stable/docs/reference/api/geopandas.GeoDataFrame.html</span>
<span class="sd">    .. _MaskedArray: https://numpy.org/doc/stable/reference/maskedarray.generic.html</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PlotTopologies.__init__">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">plate_reconstruction</span><span class="p">,</span>
        <span class="n">coastlines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">continents</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">COBs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">140.0</span><span class="p">,</span>
        <span class="n">anchor_plate_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">plot_engine</span><span class="p">:</span> <span class="n">PlotEngine</span> <span class="o">=</span> <span class="n">CartopyPlotEngine</span><span class="p">(),</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor. Create a :class:`PlotTopologies` object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        plate_reconstruction : PlateReconstruction</span>
<span class="sd">            The :class:`PlateReconstruction` object will be used to access a plate</span>
<span class="sd">            ``rotation_model`` and a set of ``topology_features`` which contains plate boundary</span>
<span class="sd">            features like trenches, ridges and transforms.</span>
<span class="sd">        coastlines : str, or `pygplates.FeatureCollection`_</span>
<span class="sd">            The full string path to a coastline feature file. Coastline features can also</span>
<span class="sd">            be passed as a `pygplates.FeatureCollection`_ object (this is</span>
<span class="sd">            the case if these features are sourced from the :class:`DataServer` object).</span>
<span class="sd">        continents : str, or `pygplates.FeatureCollection`_</span>
<span class="sd">            The full string path to a continent feature file. Continent features can also</span>
<span class="sd">            be passed as a `pygplates.FeatureCollection`_ object (this is</span>
<span class="sd">            the case if these features are sourced from the :class:`DataServer` object).</span>
<span class="sd">        COBs : str, or `pygplates.FeatureCollection`_</span>
<span class="sd">            The full string path to a COB feature file. COB features can also be passed</span>
<span class="sd">            as a `pygplates.FeatureCollection`_ object (this is the case</span>
<span class="sd">            if these features are sourced from the :class:`DataServer` object).</span>
<span class="sd">        time: float</span>
<span class="sd">            The time (Ma) to reconstruct and plot geological features to.</span>
<span class="sd">        anchor_plate_id : int, optional</span>
<span class="sd">            Anchor plate ID for reconstruction.</span>
<span class="sd">            Defaults to the current anchor plate ID of ``plate_reconstruction`` (its ``anchor_plate_id`` attribute).</span>
<span class="sd">        plot_engine : :class:`PlotEngine`, default=CartopyPlotEngine()</span>
<span class="sd">            Use Cartopy (:class:`CartopyPlotEngine`) or pyGMT (:class:`PygmtPlotEngine`) to plot the map.</span>


<span class="sd">        .. _pygplates.FeatureCollection: https://www.gplates.org/docs/pygplates/generated/pygplates.featurecollection#pygplates.FeatureCollection</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_engine</span> <span class="o">=</span> <span class="n">plot_engine</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span> <span class="o">=</span> <span class="n">plate_reconstruction</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The :class:`PlateReconstruction` object will be used to access a plate ``rotation_model`` and a set of ``topology_features``</span>
<span class="sd">        which contains plate boundary features like trenches, ridges and transforms.</span>

<span class="sd">        :type: PlateReconstruction</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">topology_features</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">topology_features</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Plate model does not have topology features.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">base_projection</span> <span class="o">=</span> <span class="n">DEFAULT_CARTOPY_PROJECTION</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cartopy map projection. Defaults to ``cartopy.crs.PlateCarree``.</span>
<span class="sd">        </span>
<span class="sd">        .. seealso::</span>
<span class="sd">        </span>
<span class="sd">            `Cartopy projection list &lt;https://scitools.org.uk/cartopy/docs/v0.15/crs/projections.html&gt;`__.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Pickle the __init__ arguments used to create coastline/continent/COB FeatureCollection&#39;s (see __reduce__ for details).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coastlines_pickle</span> <span class="o">=</span> <span class="n">coastlines</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_continents_pickle</span> <span class="o">=</span> <span class="n">continents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_COBs_pickle</span> <span class="o">=</span> <span class="n">COBs</span>
        <span class="c1"># Load the coastline/continent/COB FeatureCollection&#39;s.</span>
        <span class="c1">#</span>
        <span class="c1"># These will get used to create reconstructed geometries when the time is updated.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coastlines</span> <span class="o">=</span> <span class="n">_load_FeatureCollection</span><span class="p">(</span><span class="n">coastlines</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_continents</span> <span class="o">=</span> <span class="n">_load_FeatureCollection</span><span class="p">(</span><span class="n">continents</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_COBs</span> <span class="o">=</span> <span class="n">_load_FeatureCollection</span><span class="p">(</span><span class="n">COBs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">coastlines</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A list containing coastline features reconstructed to the specified ``time`` attribute.</span>

<span class="sd">        :type: iterable/list of `pygplates.ReconstructedFeatureGeometry`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">continents</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A list containing continent features reconstructed to the specified ``time`` attribute.</span>
<span class="sd">        </span>
<span class="sd">        :type: iterable/list of `pygplates.ReconstructedFeatureGeometry`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">COBs</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A list containing COB features reconstructed to the specified ``time`` attribute.</span>

<span class="sd">        :type: iterable/list of `pygplates.ReconstructedFeatureGeometry`_</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trenches</span> <span class="o">=</span> <span class="p">[]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A list containing trench boundary sections of type `pygplates.FeatureType.gpml_subduction_zone`.</span>
<span class="sd">        </span>
<span class="sd">        :type: iterable/list of `pygplates.Feature`_</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trench_left</span> <span class="o">=</span> <span class="p">[]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A list containing left subduction boundary sections of type `pygplates.FeatureType.gpml_subduction_zone`.</span>
<span class="sd">        </span>
<span class="sd">        :type: iterable/list of `pygplates.Feature`_</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trench_right</span> <span class="o">=</span> <span class="p">[]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A list containing right subduction boundary sections of type pygplates.FeatureType.gpml_subduction_zone</span>

<span class="sd">        :type: iterable/list of `pygplates.Feature`_</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">other</span> <span class="o">=</span> <span class="p">[]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A list containing other geological features like unclassified features, extended continental crusts,</span>
<span class="sd">        continental rifts, faults, orogenic belts, fracture zones, inferred paleo boundaries, terrane</span>
<span class="sd">        boundaries and passive continental boundaries.</span>
<span class="sd">        </span>
<span class="sd">        :type: iterable/list of `pygplates.Feature`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_topological_plate_boundaries</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_topologies</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ridges</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_transforms</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_engine</span> <span class="o">=</span> <span class="n">plot_engine</span>

        <span class="k">if</span> <span class="n">anchor_plate_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Default to the anchor plate of &#39;self.plate_reconstruction&#39;.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_anchor_plate_id</span><span class="p">(</span><span class="n">anchor_plate_id</span><span class="p">)</span>

        <span class="c1"># Note: This calls &#39;update_time()&#39; which reconstructs our features and topologies.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">time</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Arguments for __init__.</span>
        <span class="c1">#</span>
        <span class="c1"># Note: Instead of pickling the coastline/continent/COB FeatureCollection&#39;s we&#39;re pickling the __init__ arguments</span>
        <span class="c1">#       used to create them. And if they are just filenames then it ends up being faster to rebuild the FeatureCollection&#39;s</span>
        <span class="c1">#       (from files when __init__ is called during unpickling) than it is to pickle/unpickle the FeatureCollection&#39;s.</span>
        <span class="n">init_args</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_coastlines_pickle</span><span class="p">,</span>  <span class="c1"># pickle the __init__ argument</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_continents_pickle</span><span class="p">,</span>  <span class="c1"># pickle the __init__ argument</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_COBs_pickle</span><span class="p">,</span>  <span class="c1"># pickle the __init__ argument</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">,</span>  <span class="c1"># is always valid (due to &#39;self.time = time&#39; in __init__)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span><span class="p">,</span>  <span class="c1"># can be None (meaning use PlateReconstruction&#39;s anchor plate ID)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_engine</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># The reason we implement __reduce__ is so that __init__ gets called.</span>
        <span class="c1">#</span>
        <span class="c1"># We do this instead of implementing __getstate__ (where __init__ doesn&#39;t get called) since it&#39;s easier to keep</span>
        <span class="c1"># things in sync, otherwise __setstate__ would need to stay in sync with __init__ whenever __init_&#39;s code gets modified.</span>
        <span class="c1">#</span>
        <span class="c1"># It also means we don&#39;t have to worry about pickling the *reconstructed* features and topologies.</span>
        <span class="c1"># These are unpickable items because pygplates reconstructed feature geometries and resolved topological geometries</span>
        <span class="c1"># cannot be pickled (only the *unreconstructed* pygplates features and features collections can be pickled).</span>
        <span class="c1">#</span>
        <span class="c1"># Note: We set the 3rd tuple element (the object state) to None so that __setstate__ doesn&#39;t get called since</span>
        <span class="c1">#       we currently don&#39;t need to set any extra state beyond what __init__ sets up for us.</span>
        <span class="k">return</span> <span class="n">PlotTopologies</span><span class="p">,</span> <span class="n">init_args</span><span class="p">,</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">topological_plate_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resolved topologies for rigid boundaries ONLY.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_topological_plate_boundaries</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">topologies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resolved topologies for BOTH rigid boundaries and networks.</span>
<span class="sd">        A list containing assorted topologies like:</span>

<span class="sd">        - pygplates.FeatureType.gpml_topological_network</span>
<span class="sd">        - pygplates.FeatureType.gpml_oceanic_crust</span>
<span class="sd">        - pygplates.FeatureType.gpml_topological_slab_boundary</span>
<span class="sd">        - pygplates.FeatureType.gpml_topological_closed_plate_boundary</span>

<span class="sd">        :type: iterable/list of `pygplates.Feature`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_topologies</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ridges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mid-ocean ridge features (all the features which are labelled as ``gpml:MidOceanRidge`` in the model).</span>
<span class="sd">        A list containing ridge and transform boundary sections of type `pygplates.FeatureType.gpml_mid_ocean_ridge`.</span>

<span class="sd">        :type: iterable/list of `pygplates.Feature`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;ridges&#39; property has been changed since GPlately 1.3.0. &quot;</span>
            <span class="s2">&quot;You need to check your workflow to make sure the new &#39;ridges&#39; property still suits your purpose. &quot;</span>
            <span class="s2">&quot;In earlier releases of GPlately, we used an algorithm to identify the &#39;ridges&#39; and &#39;transforms&#39; within the gpml:MidOceanRidge features. &quot;</span>
            <span class="s2">&quot;Unfortunately, the algorithm did not work very well. So we have removed the algorithm and now the &#39;ridges&#39; property contains all the features &quot;</span>
            <span class="s2">&quot;which are labelled as gpml:MidOceanRidge in the reconstruction model.&quot;</span>
        <span class="p">)</span>  <span class="c1"># use logger.debug to make the message less aggressive</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ridges</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Transform boundary features (all the features which are labelled as ``gpml:Transform`` in the model).</span>
<span class="sd">        A list containing transform boundary sections of type `pygplates.FeatureType.gpml_transforms`.</span>

<span class="sd">        :type: iterable/list of `pygplates.Feature`_</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;transforms&#39; property has been changed since GPlately 1.3.0. &quot;</span>
            <span class="s2">&quot;You need to check your workflow to make sure the new &#39;transforms&#39; property still suits your purpose. &quot;</span>
            <span class="s2">&quot;In earlier releases of GPlately, we used an algorithm to identify the &#39;ridges&#39; and &#39;transforms&#39; within the gpml:MidOceanRidge features. &quot;</span>
            <span class="s2">&quot;Unfortunately, the algorithm did not work very well. So we have removed the algorithm and now the &#39;transforms&#39; property contains all the features &quot;</span>
            <span class="s2">&quot;which are labelled as gpml:Transform in the reconstruction model.&quot;</span>
        <span class="p">)</span>  <span class="c1"># use logger.debug to make the message less aggressive</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transforms</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The time (Ma) to reconstruct and plot geological features to.</span>

<span class="sd">        :type: float</span>

<span class="sd">        .. note::</span>

<span class="sd">            You can either set the ``time`` attribute when creating the :class:`PlotTopologies` object or anytime afterwards.</span>

<span class="sd">            .. code-block:: python</span>
<span class="sd">                :linenos:</span>

<span class="sd">                # set the reconstruction time when creating the PlotTopologies object.</span>
<span class="sd">                gplot = gplately.PlotTopologies(..., time=100,...)</span>

<span class="sd">                # set the reconstruction time after PlotTopologies object is created.</span>
<span class="sd">                gplot.time = 100</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span>

    <span class="nd">@time</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the new reconstruction time.</span>

<span class="sd">        Reconstruct and resolve topologies to this new time.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the reconstruction time is invalid or less then 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">new_time_f</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_time</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The new &#39;time&#39; (</span><span class="si">{</span><span class="n">new_time</span><span class="si">}</span><span class="s2">) is not a number.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">new_time_f</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The new &#39;time&#39; (</span><span class="si">{</span><span class="n">new_time</span><span class="si">}</span><span class="s2">) must be greater than 0.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_time&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
            <span class="n">new_time_f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="n">new_time_f</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_time</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;The new reconstruction &#39;time&#39; is the same with the old one. Do nothing!&quot;</span>
            <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">anchor_plate_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Anchor plate ID for reconstruction. Must be an integer &gt;= 0.</span>
<span class="sd">        Defaults to :attr:`PlateReconstruction.anchor_plate_id`.</span>

<span class="sd">        :type: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Default to anchor plate of &#39;self.plate_reconstruction&#39;.</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">anchor_plate_id</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span>

    <span class="nd">@anchor_plate_id</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">anchor_plate_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">anchor_plate</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">anchor_plate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># We&#39;ll use the anchor plate of &#39;self.plate_reconstruction&#39;.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_anchor_plate_id</span><span class="p">(</span><span class="n">anchor_plate</span><span class="p">)</span>

        <span class="c1"># Reconstructed/resolved geometries depend on the anchor plate.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_time</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_check_anchor_plate_id</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">id</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid anchor plate ID: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">id</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">id</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ridge_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deprecated! DO NOT USE!</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Deprecated! DO NOT USE!&quot;</span>
            <span class="s2">&quot;The &#39;ridge_transforms&#39; property will be removed in the future GPlately releases. &quot;</span>
            <span class="s2">&quot;Update your workflow to use the &#39;ridges&#39; and &#39;transforms&#39; properties instead, &quot;</span>
            <span class="s2">&quot;otherwise your workflow will not work with the future GPlately releases.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;ridge_transforms&#39; property has been changed since GPlately 1.3.0. &quot;</span>
            <span class="s2">&quot;You need to check your workflow to make sure the new &#39;ridge_transforms&#39; property still suits your purpose. &quot;</span>
            <span class="s2">&quot;In earlier releases of GPlately, the &#39;ridge_transforms&#39; property contains only the features &quot;</span>
            <span class="s2">&quot;which are labelled as gpml:MidOceanRidge in the reconstruction model. &quot;</span>
            <span class="s2">&quot;Now, the &#39;ridge_transforms&#39; property contains both gpml:Transform and gpml:MidOceanRidge features.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ridges</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transforms</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Rereconstruct features and topologies to the :attr:`gplately.PlotTopologies.time` attribute.</span>

<span class="sd">        The following :class:`gplately.PlotTopologies` attributes are updated whenever a reconstruction ``time`` attribute is set:</span>

<span class="sd">        - resolved topology features (topological plates and networks)</span>
<span class="sd">        - ridge and transform boundary sections (resolved features)</span>
<span class="sd">        - ridge boundary sections (resolved features)</span>
<span class="sd">        - transform boundary sections (resolved features)</span>
<span class="sd">        - subduction boundary sections (resolved features)</span>
<span class="sd">        - left subduction boundary sections (resolved features)</span>
<span class="sd">        - right subduction boundary sections (resolved features)</span>
<span class="sd">        - other boundary sections (resolved features) that are not subduction zones or mid-ocean ridges(ridge/transform)</span>

<span class="sd">        Moreover, coastlines, continents and COBs are reconstructed to the new :attr:`gplately.PlotTopologies.time`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get the topological snapshot (of resolved topologies) for the current time (and our anchor plate ID).</span>
        <span class="n">topological_snapshot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">topological_snapshot</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
            <span class="c1"># If our anchor plate is None then this will use the anchor plate of &#39;self.plate_reconstruction&#39;...</span>
            <span class="n">anchor_plate_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1">#</span>
        <span class="c1"># NOTE: If you add a new data member here that&#39;s a pygplates reconstructable feature geometry or resolved topological geometry,</span>
        <span class="c1">#       then be sure to also include it in __getstate__/()__setstate__()</span>
        <span class="c1">#       (basically anything reconstructed or resolved by pygplates since those cannot be pickled).</span>
        <span class="c1">#</span>

        <span class="c1"># Extract (from the topological snapshot) resolved topologies for BOTH rigid boundaries and networks.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_topologies</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">t</span><span class="o">.</span><span class="n">get_resolved_feature</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">topological_snapshot</span><span class="o">.</span><span class="n">get_resolved_topologies</span><span class="p">(</span>
                <span class="n">resolve_topology_types</span><span class="o">=</span><span class="n">pygplates</span><span class="o">.</span><span class="n">ResolveTopologyType</span><span class="o">.</span><span class="n">boundary</span>
                <span class="o">|</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">ResolveTopologyType</span><span class="o">.</span><span class="n">network</span>
            <span class="p">)</span>
        <span class="p">]</span>

        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_topological_plate_boundaries</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ridges</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ridges_do_not_use_for_now</span><span class="p">,</span>  <span class="c1"># the algorithm to separate ridges and transforms has not been ready yet</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_transforms_do_not_use_for_now</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trenches</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trench_left</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trench_right</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">other</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="n">ptt</span><span class="o">.</span><span class="n">resolve_topologies</span><span class="o">.</span><span class="n">resolve_topological_snapshot_into_features</span><span class="p">(</span>
            <span class="n">topological_snapshot</span><span class="p">,</span>
            <span class="c1"># use ResolveTopologyType.boundary parameter to resolve rigid plate boundary only</span>
            <span class="c1"># because the Mid-ocean ridges(and transforms) should not contain lines from topological networks</span>
            <span class="n">resolve_topology_types</span><span class="o">=</span><span class="n">pygplates</span><span class="o">.</span><span class="n">ResolveTopologyType</span><span class="o">.</span><span class="n">boundary</span><span class="p">,</span>  <span class="c1"># type: ignore</span>
        <span class="p">)</span>

        <span class="c1"># miscellaneous boundaries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">continental_rifts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">faults</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fracture_zones</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inferred_paleo_boundaries</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terrane_boundaries</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transitional_crusts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orogenic_belts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sutures</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">continental_crusts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extended_continental_crusts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">passive_continental_boundaries</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slab_edges</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unclassified_features</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_transforms</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">topol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">other</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_continental_rift</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">continental_rifts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_fault</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">faults</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_fracture_zone</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fracture_zones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span>
                <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_inferred_paleo_boundary</span>  <span class="c1"># type: ignore</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inferred_paleo_boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_terrane_boundary</span>  <span class="c1"># type: ignore</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">terrane_boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span>
                <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_transitional_crust</span>  <span class="c1"># type: ignore</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">transitional_crusts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_orogenic_belt</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">orogenic_belts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_suture</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sutures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_continental_crust</span>  <span class="c1"># type: ignore</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">continental_crusts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span>
                <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_extended_continental_crust</span>  <span class="c1"># type: ignore</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">extended_continental_crusts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span>
                <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_passive_continental_boundary</span>  <span class="c1"># type: ignore</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">passive_continental_boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_slab_edge</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">slab_edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_transform</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_transforms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">topol</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span>
                <span class="o">==</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">FeatureType</span><span class="o">.</span><span class="n">gpml_unclassified_feature</span>  <span class="c1"># type: ignore</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unclassified_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topol</span><span class="p">)</span>

        <span class="c1"># reconstruct other important polygons and lines</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coastlines</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coastlines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_coastlines</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                <span class="n">from_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="c1"># If our anchor plate is None then this will use the anchor plate of &#39;self.plate_reconstruction&#39;...</span>
                <span class="n">anchor_plate_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_continents</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">continents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_continents</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                <span class="n">from_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="c1"># If our anchor plate is None then this will use the anchor plate of &#39;self.plate_reconstruction&#39;...</span>
                <span class="n">anchor_plate_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_COBs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COBs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_COBs</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                <span class="n">from_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="c1"># If our anchor plate is None then this will use the anchor plate of &#39;self.plate_reconstruction&#39;...</span>
                <span class="n">anchor_plate_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_anchor_plate_id</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="c1"># subduction teeth</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_tessellate_triangles</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">tesselation_radians</span><span class="p">,</span> <span class="n">triangle_base_length</span><span class="p">,</span> <span class="n">triangle_aspect</span><span class="o">=</span><span class="mf">1.0</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Places subduction teeth along subduction boundary line segments within a MultiLineString shapefile.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        shapefilename  : str</span>
<span class="sd">            Path to shapefile containing the subduction boundary features</span>

<span class="sd">        tesselation_radians : float</span>
<span class="sd">            Parametrises subduction teeth density. Triangles are generated only along line segments with distances</span>
<span class="sd">            that exceed the given threshold tessellation_radians.</span>

<span class="sd">        triangle_base_length : float</span>
<span class="sd">            Length of teeth triangle base</span>

<span class="sd">        triangle_aspect : float, default=1.0</span>
<span class="sd">            Aspect ratio of teeth triangles. Ratio is 1.0 by default.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        X_points : (n,3) array</span>
<span class="sd">            X points that define the teeth triangles</span>
<span class="sd">        Y_points : (n,3) array</span>
<span class="sd">            Y points that define the teeth triangles</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">tesselation_degrees</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">tesselation_radians</span><span class="p">)</span>
        <span class="n">triangle_pointsX</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">triangle_pointsY</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">date_line_wrapper</span> <span class="o">=</span> <span class="n">pygplates</span><span class="o">.</span><span class="n">DateLineWrapper</span><span class="p">()</span>  <span class="c1"># type: ignore</span>

        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">features</span><span class="p">:</span>
            <span class="n">cum_distance</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="k">for</span> <span class="n">geometry</span> <span class="ow">in</span> <span class="n">feature</span><span class="o">.</span><span class="n">get_geometries</span><span class="p">():</span>
                <span class="n">wrapped_lines</span> <span class="o">=</span> <span class="n">date_line_wrapper</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">geometry</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">wrapped_lines</span><span class="p">:</span>
                    <span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_longitude</span><span class="p">(),</span> <span class="n">p</span><span class="o">.</span><span class="n">get_latitude</span><span class="p">())</span>
                            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">get_points</span><span class="p">()</span>
                        <span class="p">]</span>
                    <span class="p">)</span>

                    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="n">A</span> <span class="o">=</span> <span class="n">pts</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>
                        <span class="n">B</span> <span class="o">=</span> <span class="n">pts</span><span class="p">[</span><span class="n">p</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

                        <span class="n">AB_dist</span> <span class="o">=</span> <span class="n">B</span> <span class="o">-</span> <span class="n">A</span>
                        <span class="n">AB_norm</span> <span class="o">=</span> <span class="n">AB_dist</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="o">*</span><span class="n">AB_dist</span><span class="p">)</span>
                        <span class="n">cum_distance</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="o">*</span><span class="n">AB_dist</span><span class="p">)</span>

                        <span class="c1"># create a new triangle if cumulative distance is exceeded.</span>
                        <span class="k">if</span> <span class="n">cum_distance</span> <span class="o">&gt;=</span> <span class="n">tesselation_degrees</span><span class="p">:</span>
                            <span class="n">C</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">triangle_base_length</span> <span class="o">*</span> <span class="n">AB_norm</span>

                            <span class="c1"># find normal vector</span>
                            <span class="n">AD_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">AB_norm</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">AB_norm</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
                            <span class="n">AD_norm</span> <span class="o">=</span> <span class="n">AD_dist</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">AD_dist</span><span class="p">)</span>

                            <span class="n">C0</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">triangle_base_length</span> <span class="o">*</span> <span class="n">AB_norm</span>

                            <span class="c1"># project point along normal vector</span>
                            <span class="n">D</span> <span class="o">=</span> <span class="n">C0</span> <span class="o">+</span> <span class="n">triangle_base_length</span> <span class="o">*</span> <span class="n">triangle_aspect</span> <span class="o">*</span> <span class="n">AD_norm</span>

                            <span class="n">triangle_pointsX</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
                            <span class="n">triangle_pointsY</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

                            <span class="n">cum_distance</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">triangle_pointsX</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">triangle_pointsY</span><span class="p">)</span>

<div class="viewcode-block" id="PlotTopologies.get_feature">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_feature">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_feature</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">feature</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">validate_reconstruction_time</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert feature(s) to a `geopandas.GeoDataFrame`_ object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        feature : `pygplates.Feature`_, `pygplates.ReconstructedFeatureGeometry`_, pygplates.GeometryOnSphere or iterable of the aforementioned three</span>
<span class="sd">            Feature object(s).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gdf : geopandas.GeoDataFrame</span>
<span class="sd">            A `geopandas.GeoDataFrame`_ object contaning the feature geometries.</span>


<span class="sd">        .. note::</span>

<span class="sd">            The feature(s) needed to produce the `geopandas.GeoDataFrame`_ object should already be reconstructed to a ``time``.</span>
<span class="sd">            This function converts the feature(s) into a set of Shapely geometries and put them into a `geopandas.GeoDataFrame`_ object.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">feature</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;No feature(s) to convert. Make sure the `feature` parameter contains feature(s).&quot;</span>
            <span class="p">)</span>
        <span class="n">shp</span> <span class="o">=</span> <span class="n">shapelify_features</span><span class="p">(</span>
            <span class="n">feature</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">({</span><span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="n">shp</span><span class="p">},</span> <span class="n">geometry</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>  <span class="c1"># type: ignore</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_feature">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_feature">[docs]</a>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;feature&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_feature</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">feature</span><span class="p">,</span> <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot `pygplates.FeatureCollection`_ or `pygplates.Feature`_ onto a map.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">feature</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The feature (</span><span class="si">{</span><span class="n">feature_name</span><span class="si">}</span><span class="s2">) is empty and will not be plotted.&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">ax</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;edgecolor&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;edgecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
            <span class="k">if</span> <span class="s2">&quot;facecolor&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;facecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_feature</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">,</span> <span class="n">feature</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_plot_feature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">get_feature_func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;transform&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;&#39;transform&#39; keyword argument is ignored by PlotTopologies&quot;</span><span class="p">,</span>
                <span class="ne">UserWarning</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;transform&quot;</span><span class="p">)</span>
        <span class="n">tessellate_degrees</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;tessellate_degrees&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">central_meridian</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;central_meridian&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">central_meridian</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">central_meridian</span> <span class="o">=</span> <span class="n">_meridian_from_ax</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">get_feature_func</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The &#39;get_feature_func&#39; parameter must be callable.&quot;</span><span class="p">)</span>
        <span class="n">gdf</span> <span class="o">=</span> <span class="n">get_feature_func</span><span class="p">(</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Expecting a GeoDataFrame object, but the gdf is </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;No feature found for plotting. Do nothing and return.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ax</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_engine</span><span class="o">.</span><span class="n">plot_geo_data_frame</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">gdf</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="PlotTopologies.get_coastlines">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_coastlines">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;coastlines&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_coastlines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed coastlines as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coastlines</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_coastlines">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_coastlines">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;coastlines&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_coastlines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot reconstructed coastlines on a map.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coastlines</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;coastlines&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_continents">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_continents">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;continents&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_continents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed continental polygons as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">continents</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_continents">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_continents">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;continents&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_continents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the reconstructed continental polygons on a map.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">continents</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;continents&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_continent_ocean_boundaries">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_continent_ocean_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;COBs&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_continent_ocean_boundaries</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed continent-ocean boundaries as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COBs</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_continent_ocean_boundaries">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_continent_ocean_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;continent ocean boundaries&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_continent_ocean_boundaries</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the reconstructed continent-ocean boundaries (COBs) on a map.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">COBs</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;continent_ocean_boundaries&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_ridges">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_ridges">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;ridges&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_ridges</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed mid-ocean ridge lines (gpml:MidOceanRidge) as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;get_ridges&#39; function has been changed since GPlately 1.3.0. &quot;</span>
            <span class="s2">&quot;You need to check your workflow to make sure the new &#39;get_ridges&#39; function still suits your purpose. &quot;</span>
            <span class="s2">&quot;In earlier releases of GPlately, we used an algorithm to identify the &#39;ridges&#39; and &#39;transforms&#39; within the gpml:MidOceanRidge features. &quot;</span>
            <span class="s2">&quot;Unfortunately, the algorithm did not work very well. So we have removed the algorithm and now the &#39;get_ridges&#39; function returns all the features &quot;</span>
            <span class="s2">&quot;which are labelled as gpml:MidOceanRidge in the reconstruction model.&quot;</span>
        <span class="p">)</span>  <span class="c1"># use logger.debug to make the message less aggressive</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ridges</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_ridges">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_ridges">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@validate_topology_availability</span><span class="p">(</span><span class="s2">&quot;ridges&quot;</span><span class="p">)</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;ridges&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_ridges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the reconstructed mid-ocean ridge lines(gpml:MidOceanRidge) on a map.&quot;&quot;&quot;</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;plot_ridges&#39; function has been changed since GPlately 1.3.0. &quot;</span>
            <span class="s2">&quot;You need to check your workflow to make sure the new &#39;plot_ridges&#39; function still suits your purpose. &quot;</span>
            <span class="s2">&quot;In earlier releases of GPlately, we used an algorithm to identify the &#39;ridges&#39; and &#39;transforms&#39; within the gpml:MidOceanRidge features. &quot;</span>
            <span class="s2">&quot;Unfortunately, the algorithm did not work very well. So we have removed the algorithm and now the &#39;plot_ridges&#39; function plots all the features &quot;</span>
            <span class="s2">&quot;which are labelled as gpml:MidOceanRidge in the reconstruction model.&quot;</span>
        <span class="p">)</span>  <span class="c1"># use logger.debug to make the message less aggressive</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ridges</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;ridges&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_trenches">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_trenches">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;trenches&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_trenches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed trench lines as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trenches</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_ridges_and_transforms">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_ridges_and_transforms">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_ridges_and_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deprecated! DO NOT USE.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Deprecated! The &#39;get_ridges_and_transforms&#39; function will be removed in the future GPlately releases. &quot;</span>
            <span class="s2">&quot;Update your workflow to use the &#39;get_ridges&#39; and &#39;get_transforms&#39; functions instead, &quot;</span>
            <span class="s2">&quot;otherwise your workflow will not work with the future GPlately releases.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;get_ridges_and_transforms&#39; function has been changed since GPlately 1.3.0. &quot;</span>
            <span class="s2">&quot;You need to check your workflow to make sure the new &#39;get_ridges_and_transforms&#39; function still suits your purpose. &quot;</span>
            <span class="s2">&quot;In earlier releases of GPlately, we used an algorithm to identify the &#39;ridges&#39; and &#39;transforms&#39; within the gpml:MidOceanRidge features. &quot;</span>
            <span class="s2">&quot;Unfortunately, the algorithm did not work very well. So we have removed the algorithm and now the &#39;get_ridges_and_transforms&#39; function returns all the features &quot;</span>
            <span class="s2">&quot;which are labelled as gpml:MidOceanRidge or gpml:Transform in the reconstruction model.&quot;</span>
        <span class="p">)</span>  <span class="c1"># use logger.debug to make the message less aggressive</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ridges</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transforms</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_trenches">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_trenches">[docs]</a>
    <span class="nd">@validate_topology_availability</span><span class="p">(</span><span class="s2">&quot;trenches&quot;</span><span class="p">)</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;trenches&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_trenches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the reconstructed trenches on a map.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trenches</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;trenches&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_misc_boundaries">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_misc_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_misc_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed &quot;other&quot; lines as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">other</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_misc_boundaries">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_misc_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_misc_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the reconstructed miscellaneous plate boundary lines on a map.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">other</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;misc_boundaries&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_plot_subduction_teeth_deprecated</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot subduction teeth on a map.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Subduction teeth are tessellated from :attr:`gplately.PlotTopologies.trench_left` and</span>
<span class="sd">        :attr:`gplately.PlotTopologies.trench_right`, and transformed into Shapely polygons for plotting.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax :</span>
<span class="sd">            Cartopy ax or pygmt figure object.</span>

<span class="sd">        spacing : float, default=0.1</span>
<span class="sd">            The tessellation threshold (in radians). Parametrises subduction tooth density.</span>
<span class="sd">            Triangles are generated only along line segments with distances that exceed the given threshold ``spacing``.</span>

<span class="sd">        size : float, default=2.0</span>
<span class="sd">            Length of teeth triangle base.</span>

<span class="sd">        aspect : float, default=1</span>
<span class="sd">            Aspect ratio of teeth triangles. Ratio is 1.0 by default.</span>

<span class="sd">        color : str, default=&#39;black&#39;</span>
<span class="sd">            The colour of the teeth. By default, it is set to black.</span>

<span class="sd">        **kwargs :</span>
<span class="sd">            Keyword arguments for parameters such as &#39;alpha&#39;, etc. for plotting subduction tooth polygons.</span>
<span class="sd">            See `Matplotlib` keyword arguments `here &lt;https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html&gt;`__.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># add Subduction Teeth</span>
        <span class="n">subd_xL</span><span class="p">,</span> <span class="n">subd_yL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tessellate_triangles</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trench_left</span><span class="p">,</span>
            <span class="n">tesselation_radians</span><span class="o">=</span><span class="n">spacing</span><span class="p">,</span>
            <span class="n">triangle_base_length</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
            <span class="n">triangle_aspect</span><span class="o">=-</span><span class="n">aspect</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">subd_xR</span><span class="p">,</span> <span class="n">subd_yR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tessellate_triangles</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trench_right</span><span class="p">,</span>
            <span class="n">tesselation_radians</span><span class="o">=</span><span class="n">spacing</span><span class="p">,</span>
            <span class="n">triangle_base_length</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
            <span class="n">triangle_aspect</span><span class="o">=</span><span class="n">aspect</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">teeth</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">tX</span><span class="p">,</span> <span class="n">tY</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">subd_xL</span><span class="p">,</span> <span class="n">subd_yL</span><span class="p">):</span>
            <span class="n">triangle_xy_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">tX</span><span class="p">,</span> <span class="n">tY</span><span class="p">]</span>
            <span class="n">shp</span> <span class="o">=</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span><span class="n">triangle_xy_points</span><span class="p">)</span>
            <span class="n">teeth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shp</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">tX</span><span class="p">,</span> <span class="n">tY</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">subd_xR</span><span class="p">,</span> <span class="n">subd_yR</span><span class="p">):</span>
            <span class="n">triangle_xy_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">tX</span><span class="p">,</span> <span class="n">tY</span><span class="p">]</span>
            <span class="n">shp</span> <span class="o">=</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span><span class="n">triangle_xy_points</span><span class="p">)</span>
            <span class="n">teeth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shp</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_geometries</span><span class="p">(</span><span class="n">teeth</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">base_projection</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="PlotTopologies.get_subduction_direction">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_subduction_direction">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_subduction_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the :attr:`PlotTopologies.trench_left` and</span>
<span class="sd">        :attr:`PlotTopologies.trench_right` as a `geopandas.GeoDataFrame`_ object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        central_meridian : float, default=0.0</span>
<span class="sd">            The central meridian of the map. This will affect the dateline wrapping.</span>
<span class="sd">        tessellate_degrees : float or None, default=1.0</span>
<span class="sd">            If provided, geometries will be tessellated to this resolution prior to wrapping.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gdf_left :geopandas.GeoDataFrame</span>
<span class="sd">            A `geopandas.GeoDataFrame`_ object containing `trench_left` geometries.</span>
<span class="sd">        gdf_right : geopandas.GeoDataFrame</span>
<span class="sd">            A `geopandas.GeoDataFrame`_ object containing `trench_right` geometries.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trench_left</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">trench_right</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;No subduction zone/trench data is found. Make sure the plate model has topology feature.&quot;</span>
            <span class="p">)</span>

        <span class="n">trench_left_features</span> <span class="o">=</span> <span class="n">shapelify_feature_lines</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trench_left</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">trench_right_features</span> <span class="o">=</span> <span class="n">shapelify_feature_lines</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trench_right</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">gdf_left</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="n">trench_left_features</span><span class="p">},</span> <span class="n">geometry</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span>
        <span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="n">gdf_right</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="n">trench_right_features</span><span class="p">},</span> <span class="n">geometry</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span>
        <span class="p">)</span>  <span class="c1"># type: ignore</span>

        <span class="k">return</span> <span class="n">gdf_left</span><span class="p">,</span> <span class="n">gdf_right</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_subduction_teeth">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_subduction_teeth">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@validate_topology_availability</span><span class="p">(</span><span class="s2">&quot;Subduction Zones&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_subduction_teeth</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot subduction teeth.</span>

<span class="sd">        .. note::</span>

<span class="sd">            Subduction teeth are tessellated from :attr:`PlotTopologies.trench_left` and</span>
<span class="sd">            :attr:`PlotTopologies.trench_right` attributes, and transformed into Shapely polygons for plotting.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax :</span>
<span class="sd">            Cartopy ax or pygmt figure object.</span>

<span class="sd">        spacing : float, default=0.07</span>
<span class="sd">            The tessellation threshold (in radians). Parametrises subduction tooth density.</span>
<span class="sd">            Triangles are generated only along line segments with distances that exceed the given threshold ``spacing``.</span>

<span class="sd">        size : float, default=None</span>
<span class="sd">            Length of teeth triangle base (in radians). If kept at ``None``, then ``size = 0.5*spacing``.</span>

<span class="sd">        aspect : float, default=None</span>
<span class="sd">            Aspect ratio of teeth triangles. If kept at ``None``, then ``aspect = 2/3*size``.</span>

<span class="sd">        color : str, default=&#39;black&#39;</span>
<span class="sd">            The colour of the teeth. By default, it is set to black.</span>

<span class="sd">        **kwargs :</span>
<span class="sd">            Keyword arguments for plotting subduction teeth.</span>
<span class="sd">            See Matplotlib keyword arguments `here &lt;https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html&gt;`__.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;spacing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spacing</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">size</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;aspect&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">aspect</span>

        <span class="n">central_meridian</span> <span class="o">=</span> <span class="n">_meridian_from_ax</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">tessellate_degrees</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">spacing</span><span class="p">)</span>
        <span class="n">gdf_subduction_left</span><span class="p">,</span> <span class="n">gdf_subduction_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_subduction_direction</span><span class="p">(</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_engine</span><span class="o">.</span><span class="n">plot_subduction_zones</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span> <span class="n">gdf_subduction_left</span><span class="p">,</span> <span class="n">gdf_subduction_right</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_plate_polygon_by_id">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_plate_polygon_by_id">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_plate_polygon_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">plate_id</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot a plate polygon with the given ``plate_id`` on a map.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax :</span>
<span class="sd">            Cartopy ax or pygmt figure object.</span>

<span class="sd">        plate_id : int</span>
<span class="sd">            A plate ID that identifies the continental polygon to plot. See the</span>
<span class="sd">            `Global EarthByte plate IDs list &lt;https://www.earthbyte.org/webdav/ftp/earthbyte/GPlates/SampleData/FeatureCollections/Rotations/Global_EarthByte_PlateIDs_20071218.pdf&gt;`__</span>
<span class="sd">            for a full list of plate IDs.</span>

<span class="sd">        **kwargs :</span>
<span class="sd">            Keyword arguments for plotting.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">features</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">topologies</span><span class="p">:</span>
            <span class="n">features</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">feature</span>
                    <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">topologies</span>
                    <span class="k">if</span> <span class="n">feature</span><span class="o">.</span><span class="n">get_reconstruction_plate_id</span><span class="p">()</span> <span class="o">==</span> <span class="n">plate_id</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="n">features</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_plate_id">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_plate_id">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_plate_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deprecated! DO NOT USE!</span>

<span class="sd">        The function name plot_plate_id() is bad and should be changed.</span>
<span class="sd">        The new name is plot_plate_polygon_by_id().</span>
<span class="sd">        For backward compatibility, we allow users to use the old name in their legcy code for now.</span>
<span class="sd">        No new code should call this function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: remove this function</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;The class method plot_plate_id is deprecated and will be removed in the future soon. Use plot_plate_polygon_by_id instead.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_plate_polygon_by_id</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_grid">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_grid">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot a grid onto a map. The grid can be a NumPy `MaskedArray`_ object, a GPlately `Raster` object</span>
<span class="sd">        or a time-dependent raster name.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax :</span>
<span class="sd">            Cartopy ax or pygmt figure object.</span>

<span class="sd">        grid : NumPy `MaskedArray`_, GPlately `Raster` or a time-dependent raster name.</span>
<span class="sd">            A `MaskedArray`_ with elements that define a grid. The number of rows in the raster</span>
<span class="sd">            corresponds to the number of latitudinal coordinates, while the number of raster</span>
<span class="sd">            columns corresponds to the number of longitudinal coordinates.</span>
<span class="sd">            Alternatively, a GPlately `Raster` object can be provided.</span>
<span class="sd">            If a raster name is provided, the raster will be looked up from the time-dependent rasters registered in the Plate Model Manager.</span>
<span class="sd">            The :class:`gplately.PlateReconstruction` object must be created with a valid :class:`PlateModel` object.</span>

<span class="sd">        extent : tuple, default=(-180, 180, -90, 90)</span>
<span class="sd">            A tuple of 4 (min_lon, max_lon, min_lat, max_lat) representing the extent of gird.</span>


<span class="sd">        .. note::</span>

<span class="sd">            The parameters of this function are different for different plot engines. See :meth:`CartopyPlotEngine.plot_grid`</span>
<span class="sd">            and :meth:`PyGMTPlotEngine.plot_grid` for details.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># TODO: the parameters of this function need to be unified for different plot engines.</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>  <span class="c1"># grid is a raster name</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">plate_model</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s2">&quot;The &#39;plate_reconstruction&#39; does not have a valid &#39;plate_model&#39; object. &quot;</span>
                    <span class="s2">&quot;Cannot look up the raster by name. Make sure to create the &#39;plate_reconstruction&#39; with a valid &#39;plate_model&#39; object.&quot;</span>
                <span class="p">)</span>

            <span class="n">grid_data</span> <span class="o">=</span> <span class="n">Raster</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">plate_model</span><span class="o">.</span><span class="n">get_raster</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">),</span>
                <span class="n">plate_reconstruction</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="p">,</span>
                <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_engine</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span>
                <span class="n">ax</span><span class="p">,</span> <span class="n">grid_data</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">base_projection</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># grid is a MaskedArray or Raster object</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_engine</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span>
                <span class="n">ax</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">base_projection</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_grid_from_netCDF">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_grid_from_netCDF">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_grid_from_netCDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read raster data from a netCDF file, convert the data into a `MaskedArray`_ object and plot it on a map.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax :</span>
<span class="sd">            Cartopy ax.</span>

<span class="sd">        filename : str</span>
<span class="sd">            Full path to a netCDF file.</span>

<span class="sd">        **kwargs :</span>
<span class="sd">            Keyword arguments for plotting the grid. See Matplotlib&#39;s ``imshow()`` keyword arguments</span>
<span class="sd">            `here &lt;https://matplotlib.org/3.5.1/api/_as_gen/matplotlib.axes.Axes.imshow.html&gt;`__.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Override matplotlib default origin (&#39;upper&#39;)</span>
        <span class="n">origin</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;origin&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">)</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">.grids</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_netcdf_grid</span>

        <span class="n">raster</span><span class="p">,</span> <span class="n">lon_coords</span><span class="p">,</span> <span class="n">lat_coords</span> <span class="o">=</span> <span class="n">read_netcdf_grid</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">return_grids</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">lon_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lon_coords</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">lat_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_coords</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>

        <span class="k">if</span> <span class="n">lon_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lat_coords</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="s2">&quot;lower&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">origin</span> <span class="o">=</span> <span class="s2">&quot;upper&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">raster</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_plate_motion_vectors">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_plate_motion_vectors">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_plate_motion_vectors</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">spacingX</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">spacingY</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">normalise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate plate motion velocity vector fields at a particular geological time and plot them on a map.</span>

<span class="sd">        .. note::</span>

<span class="sd">            The :meth:`plot_plate_motion_vectors` generates a MeshNode domain of point features using</span>
<span class="sd">            given spacings in the X and Y directions (``spacingX`` and ``spacingY``). Each point in</span>
<span class="sd">            the domain is assigned a plate ID, and these IDs are used to obtain equivalent stage</span>
<span class="sd">            rotations of identified tectonic plates over a 5 Ma time interval. Each point and</span>
<span class="sd">            its stage rotation are used to calculate plate velocities at a particular geological</span>
<span class="sd">            time. Velocities for each domain point are represented in the north-east-down</span>
<span class="sd">            coordinate system and plotted on a GeoAxes.</span>

<span class="sd">            Vector fields can be optionally normalised by setting ``normalise`` to ``True``. This</span>
<span class="sd">            makes vector arrow lengths uniform.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax :</span>
<span class="sd">            Cartopy ax.</span>

<span class="sd">        spacingX : int, default=10</span>
<span class="sd">            The spacing in the X direction used to make the velocity domain point feature mesh.</span>

<span class="sd">        spacingY : int, default=10</span>
<span class="sd">            The spacing in the Y direction used to make the velocity domain point feature mesh.</span>

<span class="sd">        normalise : bool, default=False</span>
<span class="sd">            Choose whether to normalise the velocity magnitudes so that vector lengths are all equal.</span>

<span class="sd">        **kwargs :</span>
<span class="sd">            Keyword arguments for plotting the velocity vector field. See Matplotlib quiver keyword arguments</span>
<span class="sd">            `here &lt;https://matplotlib.org/3.5.1/api/_as_gen/matplotlib.axes.Axes.quiver.html&gt;`__.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_engine</span><span class="p">,</span> <span class="n">CartopyPlotEngine</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Plotting velocities has not been implemented for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_engine</span><span class="o">.</span><span class="vm">__class__</span><span class="si">}</span><span class="s2"> yet.&quot;</span>
            <span class="p">)</span>

        <span class="n">lonq</span><span class="p">,</span> <span class="n">latq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span> <span class="o">+</span> <span class="n">spacingX</span><span class="p">,</span> <span class="n">spacingX</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span> <span class="o">+</span> <span class="n">spacingY</span><span class="p">,</span> <span class="n">spacingY</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">lons</span> <span class="o">=</span> <span class="n">lonq</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">lats</span> <span class="o">=</span> <span class="n">latq</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

        <span class="n">delta_time</span> <span class="o">=</span> <span class="mf">5.0</span>

        <span class="n">velocity_lons</span><span class="p">,</span> <span class="n">velocity_lats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plate_reconstruction</span><span class="o">.</span><span class="n">get_point_velocities</span><span class="p">(</span>
            <span class="n">lons</span><span class="p">,</span>
            <span class="n">lats</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
            <span class="n">delta_time</span><span class="o">=</span><span class="n">delta_time</span><span class="p">,</span>
            <span class="c1"># Match previous implementation that used ptt.velocity_tools.get_plate_velocities()...</span>
            <span class="n">velocity_units</span><span class="o">=</span><span class="n">pygplates</span><span class="o">.</span><span class="n">VelocityUnits</span><span class="o">.</span><span class="n">kms_per_my</span><span class="p">,</span>
            <span class="n">return_east_north_arrays</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">normalise</span><span class="p">:</span>
            <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">velocity_lons</span><span class="p">,</span> <span class="n">velocity_lats</span><span class="p">)</span>
            <span class="n">mag</span><span class="p">[</span><span class="n">mag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">velocity_lons</span> <span class="o">/=</span> <span class="n">mag</span>
            <span class="n">velocity_lats</span> <span class="o">/=</span> <span class="n">mag</span>

        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
            <span class="n">quiver</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span>
                <span class="n">lons</span><span class="p">,</span>
                <span class="n">lats</span><span class="p">,</span>
                <span class="n">velocity_lons</span><span class="p">,</span>
                <span class="n">velocity_lats</span><span class="p">,</span>
                <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">base_projection</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">quiver</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_pole">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_pole">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_pole</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">a95</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot pole onto a matplotlib axes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax :</span>
<span class="sd">            Cartopy ax.</span>

<span class="sd">        lon : float</span>
<span class="sd">            Longitudinal coordinate to place pole.</span>
<span class="sd">        lat : float</span>
<span class="sd">            Latitudinal coordinate to place pole.</span>
<span class="sd">        a95 : float</span>
<span class="sd">            The size of the pole (in degrees).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        matplotlib.patches.Circle handle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">patches</span> <span class="k">as</span> <span class="n">mpatches</span>

        <span class="c1"># Define the projection used to display the circle:</span>
        <span class="n">proj1</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Orthographic</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="n">lon</span><span class="p">,</span> <span class="n">central_latitude</span><span class="o">=</span><span class="n">lat</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">compute_radius</span><span class="p">(</span><span class="n">ortho</span><span class="p">,</span> <span class="n">radius_degrees</span><span class="p">):</span>
            <span class="n">phi1</span> <span class="o">=</span> <span class="n">lat</span> <span class="o">+</span> <span class="n">radius_degrees</span> <span class="k">if</span> <span class="n">lat</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">lat</span> <span class="o">-</span> <span class="n">radius_degrees</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">ortho</span><span class="o">.</span><span class="n">transform_point</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">phi1</span><span class="p">,</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
            <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span>

        <span class="n">r_ortho</span> <span class="o">=</span> <span class="n">compute_radius</span><span class="p">(</span><span class="n">proj1</span><span class="p">,</span> <span class="n">a95</span><span class="p">)</span>

        <span class="c1"># adding a patch</span>
        <span class="n">patch</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
            <span class="n">mpatches</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">),</span> <span class="n">radius</span><span class="o">=</span><span class="n">r_ortho</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">proj1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">patch</span></div>


<div class="viewcode-block" id="PlotTopologies.get_continental_rifts">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_continental_rifts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;continental rifts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_continental_rifts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed contiental rift lines as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">continental_rifts</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_continental_rifts">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_continental_rifts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;continental rifts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_continental_rifts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot continental rifts on a map.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">continental_rifts</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;continental_rifts&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_faults">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_faults">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;faults&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_faults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed fault lines as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">faults</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_faults">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_faults">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;faults&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_faults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot faults on a map.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">faults</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;faults&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_fracture_zones">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_fracture_zones">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;fracture zones&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_fracture_zones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed fracture zone lines as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fracture_zones</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_fracture_zones">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_fracture_zones">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;fracturezones&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_fracture_zones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot fracture zones on a map.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fracture_zones</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;fracture_zones&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_inferred_paleo_boundaries">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_inferred_paleo_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;inferred paleo-boundaries&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_inferred_paleo_boundaries</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed inferred paleo boundary lines as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inferred_paleo_boundaries</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_inferred_paleo_boundaries">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_inferred_paleo_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;inferred paleo-boundaries&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_inferred_paleo_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot inferred paleo boundaries on a map.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inferred_paleo_boundaries</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;inferred_paleo_boundaries&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_terrane_boundaries">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_terrane_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;terrane boundaries&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_terrane_boundaries</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed terrane boundary lines as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">terrane_boundaries</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_terrane_boundaries">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_terrane_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;terrane boundaries&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_terrane_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot terrane boundaries on a map.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">terrane_boundaries</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;terrane_boundaries&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_transitional_crusts">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_transitional_crusts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;transitional crusts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_transitional_crusts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed transitional crust lines as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transitional_crusts</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_transitional_crusts">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_transitional_crusts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;transitional crusts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_transitional_crusts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot transitional crust on a map.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transitional_crusts</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;transitional_crusts&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_orogenic_belts">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_orogenic_belts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;orogenic belts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_orogenic_belts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed orogenic belt lines as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">orogenic_belts</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_orogenic_belts">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_orogenic_belts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;orogenic belts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_orogenic_belts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot orogenic belts on a map.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">orogenic_belts</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;orogenic_belts&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_sutures">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_sutures">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;sutures&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_sutures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed suture lines as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sutures</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_sutures">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_sutures">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;sutures&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_sutures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot sutures on a map.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sutures</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;sutures&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_continental_crusts">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_continental_crusts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;continental crusts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_continental_crusts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed continental crust lines as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">continental_crusts</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_continental_crusts">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_continental_crusts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;continental crusts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_continental_crusts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot continental crust lines on a map.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">continental_crusts</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;continental_crusts&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_extended_continental_crusts">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_extended_continental_crusts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;extended continental crusts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_extended_continental_crusts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed extended continental crust lines as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extended_continental_crusts</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_extended_continental_crusts">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_extended_continental_crusts">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;extended continental crusts&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_extended_continental_crusts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot extended continental crust lines on a map.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extended_continental_crusts</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;extended_continental_crusts&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_passive_continental_boundaries">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_passive_continental_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;passive continental boundaries&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_passive_continental_boundaries</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed passive continental boundary lines as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">passive_continental_boundaries</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_passive_continental_boundaries">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_passive_continental_boundaries">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;passive continental boundaries&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_passive_continental_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot passive continental boundaries on a map.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">passive_continental_boundaries</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;passive_continental_boundaries&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_slab_edges">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_slab_edges">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;slab edges&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_slab_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed slab edge lines as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slab_edges</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_slab_edges">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_slab_edges">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;slab edges&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_slab_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot slab edges on a map.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slab_edges</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;slab_edges&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_transforms">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_transforms">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;transforms&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_transforms</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed transform lines(gpml:Transform) as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;get_transforms&#39; function has been changed since GPlately 1.3.0. &quot;</span>
            <span class="s2">&quot;You need to check your workflow to make sure the new &#39;get_transforms&#39; function still suits your purpose. &quot;</span>
            <span class="s2">&quot;In earlier releases of GPlately, we used an algorithm to identify the &#39;ridges&#39; and &#39;transforms&#39; within the gpml:MidOceanRidge features. &quot;</span>
            <span class="s2">&quot;Unfortunately, the algorithm did not work very well. So we have removed the algorithm and now the &#39;get_transforms&#39; function returns all the features &quot;</span>
            <span class="s2">&quot;which are labelled as gpml:Transform in the reconstruction model.&quot;</span>
        <span class="p">)</span>  <span class="c1"># use logger.debug to make the message less aggressive</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_transforms</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_transforms">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_transforms">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;transforms&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot transform boundaries(gpml:Transform) on a map.&quot;&quot;&quot;</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;plot_transforms&#39; function has been changed since GPlately 1.3.0. &quot;</span>
            <span class="s2">&quot;You need to check your workflow to make sure the new &#39;plot_transforms&#39; function still suits your purpose. &quot;</span>
            <span class="s2">&quot;In earlier releases of GPlately, we used an algorithm to identify the &#39;ridges&#39; and &#39;transforms&#39; within the gpml:MidOceanRidge features. &quot;</span>
            <span class="s2">&quot;Unfortunately, the algorithm did not work very well. So we have removed the algorithm and now the &#39;plot_transforms&#39; function plots all the features &quot;</span>
            <span class="s2">&quot;which are labelled as gpml:Transform in the reconstruction model.&quot;</span>
        <span class="p">)</span>  <span class="c1"># use logger.debug to make the message less aggressive</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_transforms</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;transforms&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_ridges_and_transforms">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_ridges_and_transforms">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_ridges_and_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deprecated! DO NOT USE!</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Deprecated! The &#39;plot_ridges_and_transforms&#39; function will be removed in the future GPlately releases. &quot;</span>
            <span class="s2">&quot;Update your workflow to use the &#39;plot_ridges&#39; and &#39;plot_transforms&#39; functions instead, &quot;</span>
            <span class="s2">&quot;otherwise your workflow will not work with the future GPlately releases.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;The &#39;plot_ridges_and_transforms&#39; function has been changed since GPlately 1.3.0. &quot;</span>
            <span class="s2">&quot;You need to check your workflow to make sure the new &#39;plot_ridges_and_transforms&#39; function still suits your purpose. &quot;</span>
            <span class="s2">&quot;In earlier releases of GPlately, we used an algorithm to identify the &#39;ridges&#39; and &#39;transforms&#39; within the gpml:MidOceanRidge features. &quot;</span>
            <span class="s2">&quot;Unfortunately, the algorithm did not work very well. So we have removed the algorithm and now the &#39;plot_ridges_and_transforms&#39; function plots all the features &quot;</span>
            <span class="s2">&quot;which are labelled as gpml:Transform or gpml:MidOceanRidge in the reconstruction model.&quot;</span>
        <span class="p">)</span>  <span class="c1"># use logger.debug to make the message less aggressive</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ridges</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_transforms</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_unclassified_features">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_unclassified_features">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;unclassified features&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_unclassified_features</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed unclassified feature lines as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unclassified_features</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_unclassified_features">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_unclassified_features">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;unclassified features&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_unclassified_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot GPML unclassified features on a map.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unclassified_features</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;unclassified_features&quot;</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_all_topologies">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_all_topologies">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;topologies&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_all_topologies</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed topological features listed below as a `geopandas.GeoDataFrame`_ object.</span>

<span class="sd">        - pygplates.FeatureType.gpml_topological_network</span>
<span class="sd">        - pygplates.FeatureType.gpml_oceanic_crust</span>
<span class="sd">        - pygplates.FeatureType.gpml_topological_slab_boundary</span>
<span class="sd">        - pygplates.FeatureType.gpml_topological_closed_plate_boundary</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># get plate IDs and feature types to add to geodataframe</span>
        <span class="n">plate_IDs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">feature_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">all_topologies</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">topologies</span><span class="p">:</span>
            <span class="n">all_topologies</span> <span class="o">=</span> <span class="n">shapelify_features</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">topologies</span><span class="p">,</span>
                <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
                <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">topo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">topologies</span><span class="p">:</span>
                <span class="n">ft_type</span> <span class="o">=</span> <span class="n">topo</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">()</span>

                <span class="n">plate_IDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">get_reconstruction_plate_id</span><span class="p">())</span>
                <span class="n">feature_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ft_type</span><span class="p">)</span>
                <span class="n">feature_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ft_type</span><span class="o">.</span><span class="n">get_name</span><span class="p">())</span>

        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="n">all_topologies</span><span class="p">,</span>
                <span class="s2">&quot;reconstruction_plate_ID&quot;</span><span class="p">:</span> <span class="n">plate_IDs</span><span class="p">,</span>
                <span class="s2">&quot;feature_type&quot;</span><span class="p">:</span> <span class="n">feature_types</span><span class="p">,</span>
                <span class="s2">&quot;feature_name&quot;</span><span class="p">:</span> <span class="n">feature_names</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">geometry</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span>
        <span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="k">return</span> <span class="n">gdf</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_all_topologies">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_all_topologies">[docs]</a>
    <span class="nd">@validate_topology_availability</span><span class="p">(</span><span class="s2">&quot;all topologies&quot;</span><span class="p">)</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;topologies&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_all_topologies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the reconstructed topological features listed below on a map.</span>

<span class="sd">        - pygplates.FeatureType.gpml_topological_network</span>
<span class="sd">        - pygplates.FeatureType.gpml_oceanic_crust</span>
<span class="sd">        - pygplates.FeatureType.gpml_topological_slab_boundary</span>
<span class="sd">        - pygplates.FeatureType.gpml_topological_closed_plate_boundary</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;edgecolor&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;edgecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
        <span class="k">if</span> <span class="s2">&quot;facecolor&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;facecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_all_topologies</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_all_topological_sections">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_all_topological_sections">[docs]</a>
    <span class="nd">@validate_reconstruction_time</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;topological sections&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_all_topological_sections</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed topological features listed below as a `geopandas.GeoDataFrame`_ object.</span>

<span class="sd">        - ridge and transform boundary</span>
<span class="sd">        - subduction boundary</span>
<span class="sd">        - left subduction boundary</span>
<span class="sd">        - right subduction boundary</span>
<span class="sd">        - other boundary that are not subduction zones or mid-ocean ridges (ridge/transform)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># get plate IDs and feature types to add to geodataframe</span>
        <span class="n">geometries</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">plate_IDs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">feature_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">feature_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">topo</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ridges</span><span class="p">,</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">trenches</span><span class="p">,</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">trench_left</span><span class="p">,</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">trench_right</span><span class="p">,</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">other</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">converted</span> <span class="o">=</span> <span class="n">shapelify_features</span><span class="p">(</span>
                <span class="n">topo</span><span class="p">,</span>
                <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
                <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">converted</span><span class="p">,</span> <span class="n">BaseGeometry</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">converted</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">converted</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">BaseMultipartGeometry</span><span class="p">):</span>
                            <span class="n">tmp</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">geoms</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="n">converted</span> <span class="o">=</span> <span class="n">tmp</span>
                    <span class="k">del</span> <span class="n">tmp</span>
                    <span class="n">converted</span> <span class="o">=</span> <span class="n">linemerge</span><span class="p">(</span><span class="n">converted</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">converted</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">converted</span> <span class="o">=</span> <span class="n">converted</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="n">geometries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">converted</span><span class="p">)</span>
            <span class="n">plate_IDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">get_reconstruction_plate_id</span><span class="p">())</span>
            <span class="n">feature_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">get_feature_type</span><span class="p">())</span>
            <span class="n">feature_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">get_name</span><span class="p">())</span>

        <span class="n">gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;geometry&quot;</span><span class="p">:</span> <span class="n">geometries</span><span class="p">,</span>
                <span class="s2">&quot;reconstruction_plate_ID&quot;</span><span class="p">:</span> <span class="n">plate_IDs</span><span class="p">,</span>
                <span class="s2">&quot;feature_type&quot;</span><span class="p">:</span> <span class="n">feature_types</span><span class="p">,</span>
                <span class="s2">&quot;feature_name&quot;</span><span class="p">:</span> <span class="n">feature_names</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">geometry</span><span class="o">=</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">,</span>
        <span class="p">)</span>  <span class="c1"># type: ignore</span>
        <span class="k">return</span> <span class="n">gdf</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_all_topological_sections">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_all_topological_sections">[docs]</a>
    <span class="nd">@validate_topology_availability</span><span class="p">(</span><span class="s2">&quot;all topological sections&quot;</span><span class="p">)</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;topologies&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_all_topological_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the reconstructed topological features listed below on a map.</span>

<span class="sd">        - ridge and transform boundary</span>
<span class="sd">        - subduction boundary</span>
<span class="sd">        - left subduction boundary</span>
<span class="sd">        - right subduction boundary</span>
<span class="sd">        - other boundary that are not subduction zones or mid-ocean ridges (ridge/transform)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_all_topological_sections</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_topological_plate_boundaries">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_topological_plate_boundaries">[docs]</a>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">GET_DATE_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;topological plate boundaries&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_topological_plate_boundaries</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the reconstructed &quot;topological plate boundaries&quot; lines as a `geopandas.GeoDataFrame`_ object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_topological_plate_boundaries</span><span class="p">,</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span>
            <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.plot_topological_plate_boundaries">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_topological_plate_boundaries">[docs]</a>
    <span class="nd">@validate_topology_availability</span><span class="p">(</span><span class="s2">&quot;topological plate boundaries&quot;</span><span class="p">)</span>
    <span class="nd">@append_docstring</span><span class="p">(</span><span class="n">PLOT_DOCSTRING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;topological plate boundaries&quot;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_topological_plate_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the topological plate boundaries.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_topological_plate_boundaries</span><span class="p">,</span>
            <span class="n">feature_name</span><span class="o">=</span><span class="s2">&quot;topological plate boundaries&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">misc_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deprecated! DO NOT USE.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Deprecated! The &#39;misc_transforms&#39; property will be removed in the future GPlately releases. &quot;</span>
            <span class="s2">&quot;Update your workflow to use the &#39;transforms&#39; property instead, &quot;</span>
            <span class="s2">&quot;otherwise your workflow will not work with the future GPlately releases.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transforms</span>

<div class="viewcode-block" id="PlotTopologies.plot_misc_transforms">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.plot_misc_transforms">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_misc_transforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deprecated! DO NOT USE.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Deprecated! The &#39;plot_misc_transforms&#39; function will be removed in the future GPlately releases. &quot;</span>
            <span class="s2">&quot;Update your workflow to use the &#39;plot_transforms&#39; function instead, &quot;</span>
            <span class="s2">&quot;otherwise your workflow will not work with the future GPlately releases.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_transforms</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="PlotTopologies.get_misc_transforms">
<a class="viewcode-back" href="../../generated/gplately.PlotTopologies.html#gplately.PlotTopologies.get_misc_transforms">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_misc_transforms</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">central_meridian</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tessellate_degrees</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deprecated! DO NOT USE.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Deprecated! The &#39;get_misc_transforms&#39; function will be removed in the future GPlately releases. &quot;</span>
            <span class="s2">&quot;Update your workflow to use the &#39;get_transforms&#39; function instead, &quot;</span>
            <span class="s2">&quot;otherwise your workflow will not work with the future GPlately releases.&quot;</span><span class="p">,</span>
            <span class="ne">DeprecationWarning</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transforms</span><span class="p">(</span>
            <span class="n">central_meridian</span><span class="o">=</span><span class="n">central_meridian</span><span class="p">,</span> <span class="n">tessellate_degrees</span><span class="o">=</span><span class="n">tessellate_degrees</span>
        <span class="p">)</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2025, The University of Sydney.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>